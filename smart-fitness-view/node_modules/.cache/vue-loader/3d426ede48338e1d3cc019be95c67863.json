{"remainingRequest":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\SmartFitness\\smart-fitness-view\\src\\views\\user\\PublishNews.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\SmartFitness\\smart-fitness-view\\src\\views\\user\\PublishNews.vue","mtime":1748184270460},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1748086666483},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\babel-loader\\lib\\index.js","mtime":1748086666194},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1748086666483},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1748086671258}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogICAgZGF0YSgpIHsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIG5ld3NGb3JtOiB7DQogICAgICAgICAgICAgICAgbmFtZTogJycsDQogICAgICAgICAgICAgICAgdGFnSWQ6ICcnLA0KICAgICAgICAgICAgICAgIGNvdmVyOiAnJywNCiAgICAgICAgICAgICAgICBjb250ZW50OiAnJw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHRhZ3M6IFtdLA0KICAgICAgICAgICAgcnVsZXM6IHsNCiAgICAgICAgICAgICAgICBuYW1lOiBbDQogICAgICAgICAgICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaXotYTorq/moIfpopgnLCB0cmlnZ2VyOiAnYmx1cicgfSwNCiAgICAgICAgICAgICAgICAgICAgeyBtaW46IDIsIG1heDogNTAsIG1lc3NhZ2U6ICfplb/luqblnKggMiDliLAgNTAg5Liq5a2X56ymJywgdHJpZ2dlcjogJ2JsdXInIH0NCiAgICAgICAgICAgICAgICBdLA0KICAgICAgICAgICAgICAgIHRhZ0lkOiBbDQogICAgICAgICAgICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fpgInmi6nmoIfnrb4nLCB0cmlnZ2VyOiAnY2hhbmdlJyB9DQogICAgICAgICAgICAgICAgXSwNCiAgICAgICAgICAgICAgICBjb3ZlcjogWw0KICAgICAgICAgICAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+35LiK5Lyg5bCB6Z2i5Zu+54mHJywgdHJpZ2dlcjogJ2NoYW5nZScgfQ0KICAgICAgICAgICAgICAgIF0sDQogICAgICAgICAgICAgICAgY29udGVudDogWw0KICAgICAgICAgICAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWl6LWE6K6v5YaF5a65JywgdHJpZ2dlcjogJ2JsdXInIH0sDQogICAgICAgICAgICAgICAgICAgIHsgbWluOiAxMCwgbWVzc2FnZTogJ+WGheWuueS4jeiDveWwkeS6jjEw5Liq5a2X56ymJywgdHJpZ2dlcjogJ2JsdXInIH0NCiAgICAgICAgICAgICAgICBdDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9LA0KICAgIGNyZWF0ZWQoKSB7DQogICAgICAgIHRoaXMubG9hZFRhZ3MoKTsNCiAgICB9LA0KICAgIG1ldGhvZHM6IHsNCiAgICAgICAgZ29CYWNrKCkgew0KICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy91c2VyJyk7DQogICAgICAgIH0sDQogICAgICAgIGxvYWRUYWdzKCkgew0KICAgICAgICAgICAgY29uc3QgcXVlcnlEdG8gPSB7DQogICAgICAgICAgICAgICAgY3VycmVudDogMSwNCiAgICAgICAgICAgICAgICBzaXplOiAxMDAgIC8vIOiuvue9ruS4gOS4qui+g+Wkp+eahOWAvOS7peiOt+WPluaJgOacieagh+etvg0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIHRoaXMuJGF4aW9zLnBvc3QoJy90YWdzL3F1ZXJ5JywgcXVlcnlEdG8pLnRoZW4ocmVzcG9uc2UgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IHsgZGF0YSB9ID0gcmVzcG9uc2U7DQogICAgICAgICAgICAgICAgaWYgKGRhdGEuY29kZSA9PT0gMjAwKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudGFncyA9IGRhdGEuZGF0YS5yZWNvcmRzIHx8IGRhdGEuZGF0YTsgIC8vIOWFvOWuueWIhumhteWSjOmdnuWIhumhtei/lOWbng0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+agh+etvuWKoOi9veWksei0pScpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCfliqDovb3moIfnrb7lpLHotKU6JywgZXJyb3IpOw0KICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+agh+etvuWKoOi9veWksei0pScpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0sDQogICAgICAgIGhhbmRsZUF2YXRhclN1Y2Nlc3MocmVzLCBmaWxlKSB7DQogICAgICAgICAgICBpZiAocmVzLmNvZGUgIT09IDIwMCkgew0KICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+WwgemdouS4iuS8oOWksei0pScpOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5bCB6Z2i5LiK5Lyg5oiQ5YqfJyk7DQogICAgICAgICAgICB0aGlzLm5ld3NGb3JtLmNvdmVyID0gcmVzLmRhdGE7DQogICAgICAgIH0sDQogICAgICAgIHN1Ym1pdEZvcm0oZm9ybU5hbWUpIHsNCiAgICAgICAgICAgIHRoaXMuJHJlZnNbZm9ybU5hbWVdLnZhbGlkYXRlKCh2YWxpZCkgPT4gew0KICAgICAgICAgICAgICAgIGlmICh2YWxpZCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRheGlvcy5wb3N0KCcvbmV3cy9zYXZlJywgdGhpcy5uZXdzRm9ybSkudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB7IGRhdGEgfSA9IHJlc3BvbnNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuY29kZSA9PT0gMjAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCflj5HluIPmiJDlip8nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnL25ld3MtcmVjb3JkJyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoZGF0YS5tc2cgfHwgJ+WPkeW4g+Wksei0pScpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChlcnJvciA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCflj5HluIPlpLHotKU6JywgZXJyb3IpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5Y+R5biD5aSx6LSlJyk7DQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9LA0KICAgICAgICByZXNldEZvcm0oZm9ybU5hbWUpIHsNCiAgICAgICAgICAgIHRoaXMuJHJlZnNbZm9ybU5hbWVdLnJlc2V0RmllbGRzKCk7DQogICAgICAgIH0NCiAgICB9DQp9DQo="},{"version":3,"sources":["PublishNews.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PublishNews.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\r\n    <div style=\"padding: 20px 50px;\">\r\n        <div>\r\n            <p style=\"font-size: 24px;padding: 10px 0;font-weight: bolder;\">\r\n                <span @click=\"goBack\" style=\"cursor: pointer;display: inline-block;padding: 0 20px 0 0;\">\r\n                    <i class=\"el-icon-arrow-left\"></i>\r\n                    返回首页\r\n                </span>\r\n                发布资讯\r\n            </p>\r\n        </div>\r\n        <div style=\"height: 6px;background-color: rgb(248, 248, 248);\"></div>\r\n        <div style=\"padding: 20px 0;\">\r\n            <el-form :model=\"newsForm\" :rules=\"rules\" ref=\"newsForm\" label-width=\"100px\">\r\n                <el-form-item label=\"标题\" prop=\"name\">\r\n                    <el-input v-model=\"newsForm.name\" placeholder=\"请输入资讯标题\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"标签\" prop=\"tagId\">\r\n                    <el-select v-model=\"newsForm.tagId\" placeholder=\"请选择标签\" style=\"width: 100%;\">\r\n                        <el-option\r\n                            v-for=\"tag in tags\"\r\n                            :key=\"tag.id\"\r\n                            :label=\"tag.name\"\r\n                            :value=\"tag.id\">\r\n                        </el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n                <el-form-item label=\"封面\" prop=\"cover\">\r\n                    <el-upload class=\"avatar-uploader\" action=\"http://localhost:21090/api/smart-fitness/v1.0/file/upload\"\r\n                        :show-file-list=\"false\" :on-success=\"handleAvatarSuccess\">\r\n                        <img v-if=\"newsForm.cover\" :src=\"newsForm.cover\" style=\"height: 200px;width: 200px;\">\r\n                        <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n                    </el-upload>\r\n                </el-form-item>\r\n                <el-form-item label=\"内容\" prop=\"content\">\r\n                    <el-input type=\"textarea\" v-model=\"newsForm.content\" :rows=\"10\" placeholder=\"请输入资讯内容\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item>\r\n                    <el-button type=\"primary\" @click=\"submitForm('newsForm')\">发布</el-button>\r\n                    <el-button @click=\"resetForm('newsForm')\">重置</el-button>\r\n                </el-form-item>\r\n            </el-form>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    data() {\r\n        return {\r\n            newsForm: {\r\n                name: '',\r\n                tagId: '',\r\n                cover: '',\r\n                content: ''\r\n            },\r\n            tags: [],\r\n            rules: {\r\n                name: [\r\n                    { required: true, message: '请输入资讯标题', trigger: 'blur' },\r\n                    { min: 2, max: 50, message: '长度在 2 到 50 个字符', trigger: 'blur' }\r\n                ],\r\n                tagId: [\r\n                    { required: true, message: '请选择标签', trigger: 'change' }\r\n                ],\r\n                cover: [\r\n                    { required: true, message: '请上传封面图片', trigger: 'change' }\r\n                ],\r\n                content: [\r\n                    { required: true, message: '请输入资讯内容', trigger: 'blur' },\r\n                    { min: 10, message: '内容不能少于10个字符', trigger: 'blur' }\r\n                ]\r\n            }\r\n        }\r\n    },\r\n    created() {\r\n        this.loadTags();\r\n    },\r\n    methods: {\r\n        goBack() {\r\n            this.$router.push('/user');\r\n        },\r\n        loadTags() {\r\n            const queryDto = {\r\n                current: 1,\r\n                size: 100  // 设置一个较大的值以获取所有标签\r\n            };\r\n            this.$axios.post('/tags/query', queryDto).then(response => {\r\n                const { data } = response;\r\n                if (data.code === 200) {\r\n                    this.tags = data.data.records || data.data;  // 兼容分页和非分页返回\r\n                } else {\r\n                    this.$message.error('标签加载失败');\r\n                }\r\n            }).catch(error => {\r\n                console.error('加载标签失败:', error);\r\n                this.$message.error('标签加载失败');\r\n            });\r\n        },\r\n        handleAvatarSuccess(res, file) {\r\n            if (res.code !== 200) {\r\n                this.$message.error('封面上传失败');\r\n                return;\r\n            }\r\n            this.$message.success('封面上传成功');\r\n            this.newsForm.cover = res.data;\r\n        },\r\n        submitForm(formName) {\r\n            this.$refs[formName].validate((valid) => {\r\n                if (valid) {\r\n                    this.$axios.post('/news/save', this.newsForm).then(response => {\r\n                        const { data } = response;\r\n                        if (data.code === 200) {\r\n                            this.$message.success('发布成功');\r\n                            this.$router.push('/news-record');\r\n                        } else {\r\n                            this.$message.error(data.msg || '发布失败');\r\n                        }\r\n                    }).catch(error => {\r\n                        console.error('发布失败:', error);\r\n                        this.$message.error('发布失败');\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        resetForm(formName) {\r\n            this.$refs[formName].resetFields();\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.avatar-uploader {\r\n    border: 1px dashed #d9d9d9;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n    position: relative;\r\n    overflow: hidden;\r\n    width: 200px;\r\n    height: 200px;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n}\r\n\r\n.avatar-uploader:hover {\r\n    border-color: #409EFF;\r\n}\r\n\r\n.avatar-uploader-icon {\r\n    font-size: 28px;\r\n    color: #8c939d;\r\n    width: 200px;\r\n    height: 200px;\r\n    line-height: 200px;\r\n    text-align: center;\r\n}\r\n</style> "]}]}