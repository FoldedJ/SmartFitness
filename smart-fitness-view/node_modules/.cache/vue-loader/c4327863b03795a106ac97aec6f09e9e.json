{"remainingRequest":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\SmartFitness\\smart-fitness-view\\src\\views\\user\\NutritionTarget.vue?vue&type=style&index=0&id=08ab7d02&scoped=true&lang=css&","dependencies":[{"path":"E:\\SmartFitness\\smart-fitness-view\\src\\views\\user\\NutritionTarget.vue","mtime":1750139123676},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\css-loader\\dist\\cjs.js","mtime":1749639516075},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1749639525775},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\postcss-loader\\src\\index.js","mtime":1749639521038},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1749639512193},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1749639525774}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLm51dHJpdGlvbi10YXJnZXQtY29udGFpbmVyIHsNCiAgcGFkZGluZzogMjBweDsNCn0NCg0KLm51dHJpdGlvbi1pdGVtIHsNCiAgdGV4dC1hbGlnbjogY2VudGVyOw0KICBwYWRkaW5nOiAyMHB4Ow0KICBib3JkZXI6IDFweCBzb2xpZCAjZTRlN2VkOw0KICBib3JkZXItcmFkaXVzOiA0cHg7DQogIGJhY2tncm91bmQtY29sb3I6ICNmOWY5Zjk7DQp9DQoNCi5udXRyaXRpb24tbGFiZWwgew0KICBmb250LXNpemU6IDE0cHg7DQogIGNvbG9yOiAjNjA2MjY2Ow0KICBtYXJnaW4tYm90dG9tOiA4cHg7DQp9DQoNCi5udXRyaXRpb24tdmFsdWUgew0KICBmb250LXNpemU6IDI0cHg7DQogIGZvbnQtd2VpZ2h0OiBib2xkOw0KICBjb2xvcjogIzQwOWVmZjsNCn0NCg0KLnVuaXQtbGFiZWwgew0KICBtYXJnaW4tbGVmdDogOHB4Ow0KICBjb2xvcjogIzkwOTM5OTsNCn0NCg0KLmNsZWFyZml4OmJlZm9yZSwNCi5jbGVhcmZpeDphZnRlciB7DQogIGRpc3BsYXk6IHRhYmxlOw0KICBjb250ZW50OiAiIjsNCn0NCg0KLmNsZWFyZml4OmFmdGVyIHsNCiAgY2xlYXI6IGJvdGg7DQp9DQo="},{"version":3,"sources":["NutritionTarget.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgUA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"NutritionTarget.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\r\n  <div class=\"nutrition-target-container\">\r\n    <el-card class=\"box-card\">\r\n      <div slot=\"header\" class=\"clearfix\">\r\n        <span>我的营养目标</span>\r\n        <div style=\"float: right;\">\r\n          <el-button type=\"primary\" size=\"small\" @click=\"editTarget\">编辑目标</el-button>\r\n          <el-button size=\"small\" style=\"margin-left: 8px\" @click=\"generateRecommendation\" :loading=\"loading\">生成推荐</el-button>\r\n        </div>\r\n      </div>\r\n      \r\n      <el-row :gutter=\"20\">\r\n        <el-col :span=\"8\">\r\n          <div class=\"nutrition-item\">\r\n            <div class=\"nutrition-label\">每日卡路里</div>\r\n            <div class=\"nutrition-value\">{{ targetData.calories || 0 }} 千卡</div>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <div class=\"nutrition-item\">\r\n            <div class=\"nutrition-label\">蛋白质</div>\r\n            <div class=\"nutrition-value\">{{ formatNumber(targetData.protein) }} 克</div>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <div class=\"nutrition-item\">\r\n            <div class=\"nutrition-label\">碳水化合物</div>\r\n            <div class=\"nutrition-value\">{{ formatNumber(targetData.carbohydrate) }} 克</div>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n      \r\n      <el-divider></el-divider>\r\n      \r\n      <el-row :gutter=\"20\">\r\n        <el-col :span=\"8\">\r\n          <div class=\"nutrition-item\">\r\n            <div class=\"nutrition-label\">脂肪</div>\r\n            <div class=\"nutrition-value\">{{ formatNumber(targetData.fat) }} 克</div>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <div class=\"nutrition-item\">\r\n            <div class=\"nutrition-label\">膳食纤维</div>\r\n            <div class=\"nutrition-value\">{{ formatNumber(targetData.fiber) }} 克</div>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <div class=\"nutrition-item\">\r\n            <div class=\"nutrition-label\">钠</div>\r\n            <div class=\"nutrition-value\">{{ formatNumber(targetData.sodium) }} 毫克</div>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n      \r\n      <el-divider></el-divider>\r\n      \r\n      <el-descriptions title=\"用户信息\" :column=\"3\" border>\r\n        <el-descriptions-item label=\"姓名\">{{ targetData.userName || '未设置' }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"性别\">{{ targetData.gender || '未设置' }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"年龄\">{{ targetData.age || '未设置' }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"身高\">{{ targetData.height ? `${targetData.height} 厘米` : '未设置' }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"体重\">{{ targetData.weight ? `${targetData.weight} 千克` : '未设置' }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"BMI\">{{ targetData.bmi || '未计算' }}</el-descriptions-item>\r\n      </el-descriptions>\r\n    </el-card>\r\n    \r\n    <!-- 编辑目标对话框 -->\r\n    <el-dialog\r\n      title=\"编辑营养目标\"\r\n      :visible.sync=\"targetModalVisible\"\r\n      width=\"600px\"\r\n      :close-on-click-modal=\"false\"\r\n    >\r\n      <el-form :model=\"editingTarget\" label-width=\"120px\">\r\n        <el-form-item label=\"每日卡路里\">\r\n          <el-input-number v-model=\"editingTarget.calories\" :min=\"0\" :max=\"10000\" style=\"width: 100%\"></el-input-number>\r\n          <span class=\"unit-label\">千卡</span>\r\n        </el-form-item>\r\n        <el-form-item label=\"蛋白质\">\r\n          <el-input-number v-model=\"editingTarget.protein\" :min=\"0\" :max=\"1000\" :precision=\"1\" style=\"width: 100%\"></el-input-number>\r\n          <span class=\"unit-label\">克</span>\r\n        </el-form-item>\r\n        <el-form-item label=\"碳水化合物\">\r\n          <el-input-number v-model=\"editingTarget.carbohydrate\" :min=\"0\" :max=\"1000\" :precision=\"1\" style=\"width: 100%\"></el-input-number>\r\n          <span class=\"unit-label\">克</span>\r\n        </el-form-item>\r\n        <el-form-item label=\"脂肪\">\r\n          <el-input-number v-model=\"editingTarget.fat\" :min=\"0\" :max=\"1000\" :precision=\"1\" style=\"width: 100%\"></el-input-number>\r\n          <span class=\"unit-label\">克</span>\r\n        </el-form-item>\r\n        <el-form-item label=\"膳食纤维\">\r\n          <el-input-number v-model=\"editingTarget.fiber\" :min=\"0\" :max=\"100\" :precision=\"1\" style=\"width: 100%\"></el-input-number>\r\n          <span class=\"unit-label\">克</span>\r\n        </el-form-item>\r\n        <el-form-item label=\"钠\">\r\n          <el-input-number v-model=\"editingTarget.sodium\" :min=\"0\" :max=\"10000\" :precision=\"1\" style=\"width: 100%\"></el-input-number>\r\n          <span class=\"unit-label\">毫克</span>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"targetModalVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"saveTarget\" :loading=\"confirmLoading\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n    \r\n    <!-- 营养推荐对话框 -->\r\n    <el-dialog\r\n      title=\"营养推荐\"\r\n      :visible.sync=\"recommendationModalVisible\"\r\n      width=\"800px\"\r\n      :close-on-click-modal=\"false\"\r\n    >\r\n      <el-descriptions title=\"用户信息\" :column=\"3\" border>\r\n        <el-descriptions-item label=\"姓名\">{{ recommendationData.userName || '未设置' }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"性别\">{{ recommendationData.gender || '未设置' }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"年龄\">{{ recommendationData.age || '未设置' }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"身高\">{{ recommendationData.height ? `${recommendationData.height} 厘米` : '未设置' }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"体重\">{{ recommendationData.weight ? `${recommendationData.weight} 千克` : '未设置' }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"BMI\">{{ recommendationData.bmi || '未计算' }}</el-descriptions-item>\r\n      </el-descriptions>\r\n      \r\n      <el-divider></el-divider>\r\n      \r\n      <el-descriptions title=\"营养推荐\" :column=\"3\" border>\r\n        <el-descriptions-item label=\"每日卡路里\">{{ recommendationData.calories || 0 }} 千卡</el-descriptions-item>\r\n        <el-descriptions-item label=\"蛋白质\">{{ recommendationData.protein || 0 }} 克</el-descriptions-item>\r\n        <el-descriptions-item label=\"碳水化合物\">{{ recommendationData.carbohydrate || 0 }} 克</el-descriptions-item>\r\n        <el-descriptions-item label=\"脂肪\">{{ recommendationData.fat || 0 }} 克</el-descriptions-item>\r\n        <el-descriptions-item label=\"膳食纤维\">{{ recommendationData.fiber || 0 }} 克</el-descriptions-item>\r\n        <el-descriptions-item label=\"钠\">{{ recommendationData.sodium || 0 }} 毫克</el-descriptions-item>\r\n      </el-descriptions>\r\n      \r\n      <el-divider></el-divider>\r\n      \r\n      <el-form :model=\"recommendationData\" label-width=\"120px\">\r\n        <el-form-item label=\"备注\">\r\n          <el-input type=\"textarea\" v-model=\"recommendationData.notes\" :rows=\"4\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      \r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"recommendationModalVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"saveRecommendation\" :loading=\"confirmLoading\">保 存</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getNutritionTarget, saveNutritionTarget, generateNutritionRecommendation, saveNutritionRecommendation } from '@/api/nutrition';\r\n\r\nexport default {\r\n  name: 'NutritionTarget',\r\n  data() {\r\n    return {\r\n      // 营养目标数据\r\n      targetData: {\r\n        id: null,\r\n        userId: null,\r\n        calories: 0,\r\n        protein: 0,\r\n        carbohydrate: 0,\r\n        fat: 0,\r\n        fiber: 0,\r\n        sodium: 0,\r\n        userName: '',\r\n        gender: '',\r\n        age: null,\r\n        height: null,\r\n        weight: null,\r\n        bmi: null\r\n      },\r\n      \r\n      // 编辑中的目标数据\r\n      editingTarget: {\r\n        id: null,\r\n        userId: null,\r\n        calories: 0,\r\n        protein: 0,\r\n        carbohydrate: 0,\r\n        fat: 0,\r\n        fiber: 0,\r\n        sodium: 0\r\n      },\r\n      \r\n      // 营养推荐数据\r\n      recommendationData: {\r\n        id: null,\r\n        userId: null,\r\n        recommendationDate: null,\r\n        calories: 0,\r\n        protein: 0,\r\n        carbohydrate: 0,\r\n        fat: 0,\r\n        fiber: 0,\r\n        sodium: 0,\r\n        recommendationType: 'DAILY',\r\n        notes: '',\r\n        userName: '',\r\n        gender: '',\r\n        age: null,\r\n        height: null,\r\n        weight: null,\r\n        bmi: null\r\n      },\r\n      \r\n      // 对话框控制\r\n      targetModalVisible: false,\r\n      recommendationModalVisible: false,\r\n      confirmLoading: false,\r\n      loading: false\r\n    };\r\n  },\r\n  mounted() {\r\n    this.fetchNutritionTarget();\r\n  },\r\n  methods: {\r\n    // 获取用户营养目标\r\n    async fetchNutritionTarget() {\r\n      try {\r\n        const response = await getNutritionTarget();\r\n        if (response.data.code === 200 && response.data.data) {\r\n          this.targetData = response.data.data;\r\n        } else {\r\n          this.$message.error(response.data.msg || '获取营养目标失败');\r\n        }\r\n      } catch (error) {\r\n        console.error('获取营养目标出错:', error);\r\n        this.$message.error('获取营养目标失败');\r\n      }\r\n    },\r\n    \r\n    // 编辑目标\r\n    editTarget() {\r\n      this.editingTarget = {\r\n        id: this.targetData.id,\r\n        userId: this.targetData.userId,\r\n        calories: this.targetData.calories,\r\n        protein: this.targetData.protein,\r\n        carbohydrate: this.targetData.carbohydrate,\r\n        fat: this.targetData.fat,\r\n        fiber: this.targetData.fiber,\r\n        sodium: this.targetData.sodium\r\n      };\r\n      this.targetModalVisible = true;\r\n    },\r\n    \r\n    // 保存目标\r\n    async saveTarget() {\r\n      this.confirmLoading = true;\r\n      try {\r\n        const response = await saveNutritionTarget(this.editingTarget);\r\n        if (response.data.code === 200) {\r\n          this.$message.success('保存营养目标成功');\r\n          this.targetModalVisible = false;\r\n          await this.fetchNutritionTarget(); // 重新获取数据\r\n        } else {\r\n          this.$message.error(response.data.msg || '保存营养目标失败');\r\n        }\r\n      } catch (error) {\r\n        console.error('保存营养目标出错:', error);\r\n        this.$message.error('保存营养目标失败');\r\n      } finally {\r\n        this.confirmLoading = false;\r\n      }\r\n    },\r\n    \r\n    // 生成营养推荐\r\n    async generateRecommendation() {\r\n      // 先显示一个提示，告知用户生成推荐可能需要较长时间\r\n      this.$message.info('正在生成营养推荐，这可能需要一些时间，请耐心等待...');\r\n      this.loading = true;\r\n      try {\r\n        const response = await generateNutritionRecommendation();\r\n        if (response.data.code === 200 && response.data.data) {\r\n          this.recommendationData = response.data.data;\r\n          this.recommendationModalVisible = true;\r\n        } else {\r\n          this.$message.warning(response.data.msg || '生成营养推荐暂时失败，请稍后重试');\r\n        }\r\n      } catch (error) {\r\n        console.error('生成营养推荐出错:', error);\r\n        this.$message.warning('生成营养推荐暂时失败，请稍后重试');\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n    \r\n    // 保存推荐\r\n    async saveRecommendation() {\r\n      this.confirmLoading = true;\r\n      try {\r\n        const response = await saveNutritionRecommendation(this.recommendationData);\r\n        if (response.data.code === 200) {\r\n          this.$message.success('保存营养推荐成功');\r\n          this.recommendationModalVisible = false;\r\n        } else {\r\n          this.$message.error(response.data.msg || '保存营养推荐失败');\r\n        }\r\n      } catch (error) {\r\n        console.error('保存营养推荐出错:', error);\r\n        this.$message.error('保存营养推荐失败');\r\n      } finally {\r\n        this.confirmLoading = false;\r\n      }\r\n    },\r\n    \r\n    // 格式化数字\r\n    formatNumber(value) {\r\n      if (value === null || value === undefined) return '0';\r\n      // 处理字符串或数字\r\n      const num = parseFloat(value);\r\n      return isNaN(num) ? '0' : num.toFixed(1);\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.nutrition-target-container {\r\n  padding: 20px;\r\n}\r\n\r\n.nutrition-item {\r\n  text-align: center;\r\n  padding: 20px;\r\n  border: 1px solid #e4e7ed;\r\n  border-radius: 4px;\r\n  background-color: #f9f9f9;\r\n}\r\n\r\n.nutrition-label {\r\n  font-size: 14px;\r\n  color: #606266;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n.nutrition-value {\r\n  font-size: 24px;\r\n  font-weight: bold;\r\n  color: #409eff;\r\n}\r\n\r\n.unit-label {\r\n  margin-left: 8px;\r\n  color: #909399;\r\n}\r\n\r\n.clearfix:before,\r\n.clearfix:after {\r\n  display: table;\r\n  content: \"\";\r\n}\r\n\r\n.clearfix:after {\r\n  clear: both;\r\n}\r\n</style>"]}]}