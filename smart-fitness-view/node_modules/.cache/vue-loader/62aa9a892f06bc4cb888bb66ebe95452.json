{"remainingRequest":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\SmartFitness\\smart-fitness-view\\src\\views\\user\\UserPostManage.vue?vue&type=script&setup=true&lang=js&","dependencies":[{"path":"E:\\SmartFitness\\smart-fitness-view\\src\\views\\user\\UserPostManage.vue","mtime":1748431485570},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1748086666483},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\babel-loader\\lib\\index.js","mtime":1748086666194},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1748086666483},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1748086671258}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyByZWYsIG9uTW91bnRlZCB9IGZyb20gJ3Z1ZScNCmltcG9ydCB7IEVsTWVzc2FnZSwgRWxNZXNzYWdlQm94IH0gZnJvbSAnZWxlbWVudC1wbHVzJw0KaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSAndnVlLXJvdXRlcicNCmltcG9ydCB7IHF1ZXJ5VXNlck5ld3MsIGRlbGV0ZVVzZXJOZXdzIH0gZnJvbSAnQC9hcGkvbmV3cycNCmltcG9ydCB7IGZvcm1hdERhdGUgfSBmcm9tICdAL3V0aWxzL2Zvcm1hdCcNCg0KY29uc3Qgcm91dGVyID0gdXNlUm91dGVyKCkNCmNvbnN0IGxvYWRpbmcgPSByZWYoZmFsc2UpDQpjb25zdCBwb3N0TGlzdCA9IHJlZihbXSkNCmNvbnN0IHRvdGFsID0gcmVmKDApDQpjb25zdCBjYXRlZ29yeU9wdGlvbnMgPSByZWYoW10pDQoNCi8vIOafpeivouWPguaVsA0KY29uc3QgcXVlcnlQYXJhbXMgPSByZWYoew0KICBwYWdlTnVtOiAxLA0KICBwYWdlU2l6ZTogMTAsDQogIG5hbWU6ICcnLA0KICBjYXRlZ29yeUlkOiB1bmRlZmluZWQsDQogIHB1Ymxpc2hlcklkOiB1bmRlZmluZWQgLy8g5bCG5Zyob25Nb3VudGVk5Lit6K6+572uDQp9KQ0KDQovLyDojrflj5bluJblrZDliJfooagNCmNvbnN0IGdldExpc3QgPSBhc3luYyAoKSA9PiB7DQogIGxvYWRpbmcudmFsdWUgPSB0cnVlDQogIHRyeSB7DQogICAgY29uc3QgcmVzID0gYXdhaXQgcXVlcnlVc2VyTmV3cyhxdWVyeVBhcmFtcy52YWx1ZSkNCiAgICBpZiAocmVzLmNvZGUgPT09IDIwMCkgew0KICAgICAgcG9zdExpc3QudmFsdWUgPSByZXMuZGF0YS5saXN0DQogICAgICB0b3RhbC52YWx1ZSA9IHJlcy5kYXRhLnRvdGFsDQogICAgfQ0KICB9IGNhdGNoIChlcnJvcikgew0KICAgIGNvbnNvbGUuZXJyb3IoJ+iOt+WPluW4luWtkOWIl+ihqOWksei0pTonLCBlcnJvcikNCiAgfSBmaW5hbGx5IHsNCiAgICBsb2FkaW5nLnZhbHVlID0gZmFsc2UNCiAgfQ0KfQ0KDQovLyDmn6Xor6LmjInpkq7ngrnlh7sNCmNvbnN0IGhhbmRsZVF1ZXJ5ID0gKCkgPT4gew0KICBxdWVyeVBhcmFtcy52YWx1ZS5wYWdlTnVtID0gMQ0KICBnZXRMaXN0KCkNCn0NCg0KLy8g6YeN572u5oyJ6ZKu54K55Ye7DQpjb25zdCByZXNldFF1ZXJ5ID0gKCkgPT4gew0KICBxdWVyeVBhcmFtcy52YWx1ZSA9IHsNCiAgICBwYWdlTnVtOiAxLA0KICAgIHBhZ2VTaXplOiAxMCwNCiAgICBuYW1lOiAnJywNCiAgICBjYXRlZ29yeUlkOiB1bmRlZmluZWQsDQogICAgcHVibGlzaGVySWQ6IHF1ZXJ5UGFyYW1zLnZhbHVlLnB1Ymxpc2hlcklkDQogIH0NCiAgZ2V0TGlzdCgpDQp9DQoNCi8vIOafpeeci+W4luWtkA0KY29uc3QgaGFuZGxlVmlldyA9IChyb3cpID0+IHsNCiAgcm91dGVyLnB1c2goYC9uZXdzL2RldGFpbC8ke3Jvdy5pZH1gKQ0KfQ0KDQovLyDliKDpmaTluJblrZANCmNvbnN0IGhhbmRsZURlbGV0ZSA9IChyb3cpID0+IHsNCiAgRWxNZXNzYWdlQm94LmNvbmZpcm0oDQogICAgJ+ehruiupOimgeWIoOmZpOivpeW4luWtkOWQl++8nycsDQogICAgJ+itpuWRiicsDQogICAgew0KICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLA0KICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsDQogICAgICB0eXBlOiAnd2FybmluZycsDQogICAgfQ0KICApLnRoZW4oYXN5bmMgKCkgPT4gew0KICAgIHRyeSB7DQogICAgICBjb25zdCByZXMgPSBhd2FpdCBkZWxldGVVc2VyTmV3cyhyb3cuaWQpDQogICAgICBpZiAocmVzLmNvZGUgPT09IDIwMCkgew0KICAgICAgICBFbE1lc3NhZ2Uuc3VjY2Vzcygn5Yig6Zmk5oiQ5YqfJykNCiAgICAgICAgZ2V0TGlzdCgpDQogICAgICB9DQogICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgIGNvbnNvbGUuZXJyb3IoJ+WIoOmZpOW4luWtkOWksei0pTonLCBlcnJvcikNCiAgICB9DQogIH0pDQp9DQoNCi8vIOWIhumhteWkp+Wwj+aUueWPmA0KY29uc3QgaGFuZGxlU2l6ZUNoYW5nZSA9ICh2YWwpID0+IHsNCiAgcXVlcnlQYXJhbXMudmFsdWUucGFnZVNpemUgPSB2YWwNCiAgZ2V0TGlzdCgpDQp9DQoNCi8vIOmhteeggeaUueWPmA0KY29uc3QgaGFuZGxlQ3VycmVudENoYW5nZSA9ICh2YWwpID0+IHsNCiAgcXVlcnlQYXJhbXMudmFsdWUucGFnZU51bSA9IHZhbA0KICBnZXRMaXN0KCkNCn0NCg0Kb25Nb3VudGVkKCgpID0+IHsNCiAgLy8g6K6+572u5b2T5YmN55So5oi3SUQNCiAgcXVlcnlQYXJhbXMudmFsdWUucHVibGlzaGVySWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcklkJykNCiAgZ2V0TGlzdCgpDQp9KQ0K"},{"version":3,"sources":["UserPostManage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyFA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"UserPostManage.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\r\n  <div class=\"user-post-manage\">\r\n    <el-card class=\"box-card\">\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <span>我的帖子管理</span>\r\n        </div>\r\n      </template>\r\n      \r\n      <!-- 搜索栏 -->\r\n      <div class=\"search-bar\">\r\n        <el-form :inline=\"true\" :model=\"queryParams\" class=\"demo-form-inline\">\r\n          <el-form-item label=\"标题\">\r\n            <el-input v-model=\"queryParams.name\" placeholder=\"请输入标题\" clearable />\r\n          </el-form-item>\r\n          <el-form-item label=\"分类\">\r\n            <el-select v-model=\"queryParams.categoryId\" placeholder=\"请选择分类\" clearable>\r\n              <el-option\r\n                v-for=\"item in categoryOptions\"\r\n                :key=\"item.id\"\r\n                :label=\"item.name\"\r\n                :value=\"item.id\"\r\n              />\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <el-button type=\"primary\" @click=\"handleQuery\">查询</el-button>\r\n            <el-button @click=\"resetQuery\">重置</el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n      </div>\r\n\r\n      <!-- 帖子列表 -->\r\n      <el-table :data=\"postList\" style=\"width: 100%\" v-loading=\"loading\">\r\n        <el-table-column prop=\"coverUrl\" label=\"封面\" width=\"120\">\r\n          <template #default=\"scope\">\r\n            <el-image \r\n              style=\"width: 100px; height: 60px\"\r\n              :src=\"scope.row.coverUrl\"\r\n              :preview-src-list=\"[scope.row.coverUrl]\"\r\n              fit=\"cover\"\r\n            />\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"categoryName\" label=\"分类\" width=\"120\" />\r\n        <el-table-column prop=\"name\" label=\"标题\" min-width=\"200\" />\r\n        <el-table-column prop=\"createTime\" label=\"发布时间\" width=\"180\">\r\n          <template #default=\"scope\">\r\n            {{ formatDate(scope.row.createTime) }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"viewsNumber\" label=\"浏览量\" width=\"100\" />\r\n        <el-table-column label=\"操作\" width=\"150\" fixed=\"right\">\r\n          <template #default=\"scope\">\r\n            <el-button\r\n              type=\"primary\"\r\n              link\r\n              @click=\"handleView(scope.row)\"\r\n            >\r\n              查看\r\n            </el-button>\r\n            <el-button\r\n              type=\"danger\"\r\n              link\r\n              @click=\"handleDelete(scope.row)\"\r\n            >\r\n              删除\r\n            </el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n\r\n      <!-- 分页 -->\r\n      <div class=\"pagination-container\">\r\n        <el-pagination\r\n          v-model:current-page=\"queryParams.pageNum\"\r\n          v-model:page-size=\"queryParams.pageSize\"\r\n          :page-sizes=\"[10, 20, 30, 50]\"\r\n          :total=\"total\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n        />\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport { useRouter } from 'vue-router'\r\nimport { queryUserNews, deleteUserNews } from '@/api/news'\r\nimport { formatDate } from '@/utils/format'\r\n\r\nconst router = useRouter()\r\nconst loading = ref(false)\r\nconst postList = ref([])\r\nconst total = ref(0)\r\nconst categoryOptions = ref([])\r\n\r\n// 查询参数\r\nconst queryParams = ref({\r\n  pageNum: 1,\r\n  pageSize: 10,\r\n  name: '',\r\n  categoryId: undefined,\r\n  publisherId: undefined // 将在onMounted中设置\r\n})\r\n\r\n// 获取帖子列表\r\nconst getList = async () => {\r\n  loading.value = true\r\n  try {\r\n    const res = await queryUserNews(queryParams.value)\r\n    if (res.code === 200) {\r\n      postList.value = res.data.list\r\n      total.value = res.data.total\r\n    }\r\n  } catch (error) {\r\n    console.error('获取帖子列表失败:', error)\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 查询按钮点击\r\nconst handleQuery = () => {\r\n  queryParams.value.pageNum = 1\r\n  getList()\r\n}\r\n\r\n// 重置按钮点击\r\nconst resetQuery = () => {\r\n  queryParams.value = {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    name: '',\r\n    categoryId: undefined,\r\n    publisherId: queryParams.value.publisherId\r\n  }\r\n  getList()\r\n}\r\n\r\n// 查看帖子\r\nconst handleView = (row) => {\r\n  router.push(`/news/detail/${row.id}`)\r\n}\r\n\r\n// 删除帖子\r\nconst handleDelete = (row) => {\r\n  ElMessageBox.confirm(\r\n    '确认要删除该帖子吗？',\r\n    '警告',\r\n    {\r\n      confirmButtonText: '确定',\r\n      cancelButtonText: '取消',\r\n      type: 'warning',\r\n    }\r\n  ).then(async () => {\r\n    try {\r\n      const res = await deleteUserNews(row.id)\r\n      if (res.code === 200) {\r\n        ElMessage.success('删除成功')\r\n        getList()\r\n      }\r\n    } catch (error) {\r\n      console.error('删除帖子失败:', error)\r\n    }\r\n  })\r\n}\r\n\r\n// 分页大小改变\r\nconst handleSizeChange = (val) => {\r\n  queryParams.value.pageSize = val\r\n  getList()\r\n}\r\n\r\n// 页码改变\r\nconst handleCurrentChange = (val) => {\r\n  queryParams.value.pageNum = val\r\n  getList()\r\n}\r\n\r\nonMounted(() => {\r\n  // 设置当前用户ID\r\n  queryParams.value.publisherId = localStorage.getItem('userId')\r\n  getList()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.user-post-manage {\r\n  padding: 20px;\r\n}\r\n\r\n.search-bar {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.pagination-container {\r\n  margin-top: 20px;\r\n  display: flex;\r\n  justify-content: flex-end;\r\n}\r\n\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n</style> "]}]}