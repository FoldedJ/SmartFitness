{"remainingRequest":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\SmartFitness\\smart-fitness-view\\src\\components\\CozeAssistant.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\SmartFitness\\smart-fitness-view\\src\\components\\CozeAssistant.vue","mtime":1749652926820},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1749639512193},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\babel-loader\\lib\\index.js","mtime":1749639511518},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1749639512193},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1749639525774}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIOenu+mZpOmdmeaAgeWvvOWFpQovLyBpbXBvcnQgeyBDb3plQVBJIH0gZnJvbSAnQGNvemUvYXBpJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQ296ZUFzc2lzdGFudCcsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGlzT3BlbjogZmFsc2UsCiAgICAgIHVzZXJJbnB1dDogJycsCiAgICAgIG1lc3NhZ2VzOiBbCiAgICAgICAgeyB0eXBlOiAnYXNzaXN0YW50JywgY29udGVudDogJ+aCqOWlve+8jOaIkeaYr+aCqOeahOaZuuiDveWBpeW6t+WKqeaJi++8jOacieS7gOS5iOWPr+S7peW4ruaCqOeahOWQl++8nycgfQogICAgICBdLAogICAgICBhcGlDbGllbnQ6IG51bGwsCiAgICAgIGlzTG9hZGluZzogZmFsc2UKICAgIH07CiAgfSwKICBhc3luYyBjcmVhdGVkKCkgewogICAgdHJ5IHsKICAgICAgY29uc29sZS5sb2coJ+WIneWni+WMlkNvemVBUEnlrqLmiLfnq68uLi4nKTsKICAgICAgCiAgICAgIC8vIOWKqOaAgeWvvOWFpSBDb3plQVBJCiAgICAgIGNvbnN0IHsgQ296ZUFQSSB9ID0gYXdhaXQgaW1wb3J0KCdAY296ZS9hcGkvZGlzdC9lc20vaW5kZXguanMnKTsKICAgICAgCiAgICAgIC8vIOWIneWni+WMliBBUEkg5a6i5oi356uvCiAgICAgIHRoaXMuYXBpQ2xpZW50ID0gbmV3IENvemVBUEkoewogICAgICAgIHRva2VuOiAncGF0X1pSM2RoSUNEVVNNYXBXYXNudDFOS1cyOUxjb3l2WmxSVmRLWmV0d1o1bW9ZeENkelpxOEp1OE1VR1ptUW9GMkEnLAogICAgICAgIGJhc2VVUkw6ICdodHRwczovL2FwaS5jb3plLmNuJywKICAgICAgICBhbGxvd1BlcnNvbmFsQWNjZXNzVG9rZW5JbkJyb3dzZXI6IHRydWUKICAgICAgfSk7CiAgICAgIAogICAgICBjb25zb2xlLmxvZygnYXBpQ2xpZW505Yid5aeL5YyW57uT5p6cOicsIHRoaXMuYXBpQ2xpZW50KTsKICAgICAgCiAgICAgIC8vIOmqjOivgSBhcGlDbGllbnQg5piv5ZCm5q2j56Gu5Yid5aeL5YyWCiAgICAgIGlmICghdGhpcy5hcGlDbGllbnQpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvemUgQVBJ5a6i5oi356uv5Yid5aeL5YyW5aSx6LSl77yMYXBpQ2xpZW505Li6bnVsbCcpOwogICAgICB9CiAgICAgIAogICAgICBjb25zb2xlLmxvZygnQ296ZSBBUEnlrqLmiLfnq6/liJ3lp4vljJbmiJDlip8nLCB0aGlzLmFwaUNsaWVudCk7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICBjb25zb2xlLmVycm9yKCdDb3plIEFQSeWuouaIt+err+WIneWni+WMluWksei0pTonLCBlcnJvcik7CiAgICAgIHRoaXMubWVzc2FnZXMucHVzaCh7IAogICAgICAgIHR5cGU6ICdhc3Npc3RhbnQnLCAKICAgICAgICBjb250ZW50OiBg5pm66IO95Yqp5omL5Yid5aeL5YyW5aSx6LSl77yM6K+35Yi35paw6aG16Z2i6YeN6K+V44CC6ZSZ6K+v6K+m5oOFOiAke2Vycm9yLm1lc3NhZ2UgfHwgJ+acquefpemUmeivryd9YAogICAgICB9KTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIHRvZ2dsZUFzc2lzdGFudCgpIHsKICAgICAgdGhpcy5pc09wZW4gPSAhdGhpcy5pc09wZW47CiAgICB9LAogICAgYXN5bmMgc2VuZE1lc3NhZ2UoKSB7CiAgICAgIGlmICghdGhpcy51c2VySW5wdXQudHJpbSgpIHx8IHRoaXMuaXNMb2FkaW5nKSByZXR1cm47CiAgICAgIAogICAgICAvLyDmo4Dmn6VhcGlDbGllbnTmmK/lkKbmraPnoa7liJ3lp4vljJYKICAgICAgaWYgKCF0aGlzLmFwaUNsaWVudCkgewogICAgICAgIGNvbnN0IGVycm9yTXNnID0gJ+aZuuiDveWKqeaJi+acquato+ehruWIneWni+WMlu+8jOivt+WIt+aWsOmhtemdoumHjeivlSc7CiAgICAgICAgY29uc29sZS5lcnJvcign5pm66IO95Yqp5omL5pyq5q2j56Gu5Yid5aeL5YyW77yMYXBpQ2xpZW505LiN5a2Y5ZyoJyk7CiAgICAgICAgdGhpcy5tZXNzYWdlcy5wdXNoKHsgCiAgICAgICAgICB0eXBlOiAnYXNzaXN0YW50JywgCiAgICAgICAgICBjb250ZW50OiBlcnJvck1zZyAKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgCiAgICAgIC8vIOa3u+WKoOeUqOaIt+a2iOaBrwogICAgICB0aGlzLm1lc3NhZ2VzLnB1c2goeyB0eXBlOiAndXNlcicsIGNvbnRlbnQ6IHRoaXMudXNlcklucHV0IH0pOwogICAgICBjb25zdCB1c2VyUXVlc3Rpb24gPSB0aGlzLnVzZXJJbnB1dDsKICAgICAgdGhpcy51c2VySW5wdXQgPSAnJzsKICAgICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlOwogICAgICAKICAgICAgLy8g5re75Yqg5Li05pe25Yqg6L295raI5oGvCiAgICAgIGNvbnN0IGxvYWRpbmdNc2dJbmRleCA9IHRoaXMubWVzc2FnZXMubGVuZ3RoOwogICAgICB0aGlzLm1lc3NhZ2VzLnB1c2goeyB0eXBlOiAnYXNzaXN0YW50JywgY29udGVudDogJ+ato+WcqOaAneiAgy4uLicgfSk7CiAgICAgIAogICAgICB0cnkgewogICAgICAgIGNvbnNvbGUubG9nKCflj5HpgIHpl67popg6JywgdXNlclF1ZXN0aW9uKTsKICAgICAgICAKICAgICAgICAvLyDkvb/nlKggY2hhdCDmjqXlj6PvvIzmt7vliqAgYm90X2lkCiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5hcGlDbGllbnQuY2hhdC5jcmVhdGUoewogICAgICAgICAgYm90X2lkOiAnNzUxNDYxMzAzMjkzMzI3NzczMScsCiAgICAgICAgICBtZXNzYWdlczogW3sKICAgICAgICAgICAgcm9sZTogJ3VzZXInLAogICAgICAgICAgICBjb250ZW50OiB1c2VyUXVlc3Rpb24KICAgICAgICAgIH1dCiAgICAgICAgfSk7CiAgICAgICAgCiAgICAgICAgY29uc29sZS5sb2coJ0FQSeWujOaVtOWTjeW6lDonLCBKU09OLnN0cmluZ2lmeShyZXMsIG51bGwsIDIpKTsKICAgICAgICAKICAgICAgICAvLyDmo4Dmn6Xlk43lupTmoLzlvI8KICAgICAgICBpZiAoIXJlcykgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBUEnlk43lupTkuLrnqbonKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8g5aSE55CG6L+b6KGM5Lit55qE54q25oCB77yM6ZyA6KaB6L2u6K+i6I635Y+W57uT5p6cCiAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09ICdpbl9wcm9ncmVzcycgJiYgcmVzLmlkKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygn5a+56K+d5q2j5Zyo6L+b6KGM5Lit77yM5byA5aeL6L2u6K+i6I635Y+W57uT5p6cLi4uJyk7CiAgICAgICAgICBsZXQgcnVuSWQgPSByZXMuaWQ7CiAgICAgICAgICBsZXQgbWF4UmV0cmllcyA9IDEwOwogICAgICAgICAgbGV0IHJldHJ5Q291bnQgPSAwOwogICAgICAgICAgbGV0IG91dHB1dCA9ICcnOwogICAgICAgICAgCiAgICAgICAgICAvLyDova7or6Lojrflj5bnu5PmnpwKICAgICAgICAgIHdoaWxlIChyZXRyeUNvdW50IDwgbWF4UmV0cmllcykgewogICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwMCkpOyAvLyDnrYnlvoUx56eSCiAgICAgICAgICAgIHJldHJ5Q291bnQrKzsKICAgICAgICAgICAgCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coYOesrCR7cmV0cnlDb3VudH3mrKHova7or6Lojrflj5bnu5PmnpwuLi5gKTsKICAgICAgICAgICAgICBjb25zdCBwb2xsUmVzID0gYXdhaXQgdGhpcy5hcGlDbGllbnQuY2hhdC5yZXRyaWV2ZSh7CiAgICAgICAgICAgICAgICBpZDogcnVuSWQKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAKICAgICAgICAgICAgICBjb25zb2xlLmxvZygn6L2u6K+i5ZON5bqUOicsIEpTT04uc3RyaW5naWZ5KHBvbGxSZXMsIG51bGwsIDIpKTsKICAgICAgICAgICAgICAKICAgICAgICAgICAgICAvLyDmo4Dmn6XmmK/lkKblrozmiJAKICAgICAgICAgICAgICBpZiAocG9sbFJlcy5zdGF0dXMgPT09ICdjb21wbGV0ZWQnICYmIHBvbGxSZXMuY2hvaWNlcyAmJiBwb2xsUmVzLmNob2ljZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgb3V0cHV0ID0gcG9sbFJlcy5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudDsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfojrflj5bliLDmnIDnu4jnu5Pmnpw6Jywgb3V0cHV0KTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAocG9sbFJlcy5zdGF0dXMgPT09ICdmYWlsZWQnKSB7CiAgICAgICAgICAgICAgICBjb25zdCBlcnJvck1zZyA9IHBvbGxSZXMubGFzdF9lcnJvciAmJiBwb2xsUmVzLmxhc3RfZXJyb3IubXNnID8gcG9sbFJlcy5sYXN0X2Vycm9yLm1zZyA6ICfmnKrnn6XplJnor68nOwogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCflr7nor53lpITnkIblpLHotKU6ICcgKyBlcnJvck1zZyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIAogICAgICAgICAgICAgIC8vIOe7p+e7reetieW+hQogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGDlr7nor53ku43lnKjlpITnkIbkuK3vvIznu6fnu63nrYnlvoUuLi4gKCR7cmV0cnlDb3VudH0vJHttYXhSZXRyaWVzfSlgKTsKICAgICAgICAgICAgfSBjYXRjaCAocG9sbEVycm9yKSB7CiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcign6L2u6K+i6L+H56iL5Lit5Ye66ZSZOicsIHBvbGxFcnJvcik7CiAgICAgICAgICAgICAgdGhyb3cgcG9sbEVycm9yOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICAKICAgICAgICAgIGlmICghb3V0cHV0KSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcign6I635Y+W5a+56K+d57uT5p6c6LaF5pe277yM6K+356iN5ZCO5YaN6K+VJyk7CiAgICAgICAgICB9CiAgICAgICAgICAKICAgICAgICAgIHJldHVybiB0aGlzLiRzZXQodGhpcy5tZXNzYWdlcywgbG9hZGluZ01zZ0luZGV4LCB7IAogICAgICAgICAgICB0eXBlOiAnYXNzaXN0YW50JywgCiAgICAgICAgICAgIGNvbnRlbnQ6IG91dHB1dAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vIOWwneivleS4jeWQjOeahOWTjeW6lOagvOW8jwogICAgICAgIGxldCBvdXRwdXQgPSAnJzsKICAgICAgICBpZiAocmVzLmNob2ljZXMgJiYgcmVzLmNob2ljZXMubGVuZ3RoID4gMCAmJiByZXMuY2hvaWNlc1swXS5tZXNzYWdlKSB7CiAgICAgICAgICBvdXRwdXQgPSByZXMuY2hvaWNlc1swXS5tZXNzYWdlLmNvbnRlbnQ7CiAgICAgICAgfSBlbHNlIGlmIChyZXMuZGF0YSAmJiByZXMuZGF0YS5vdXRwdXQpIHsKICAgICAgICAgIG91dHB1dCA9IHJlcy5kYXRhLm91dHB1dDsKICAgICAgICB9IGVsc2UgaWYgKHJlcy5vdXRwdXQpIHsKICAgICAgICAgIG91dHB1dCA9IHJlcy5vdXRwdXQ7CiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgcmVzID09PSAnc3RyaW5nJykgewogICAgICAgICAgb3V0cHV0ID0gcmVzOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCfml6Dms5Xor4bliKvnmoTlk43lupTmoLzlvI86JywgcmVzKTsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcign5peg5rOV6K+G5Yir55qE5ZON5bqU5qC85byP77yM6K+35qOA5p+lQVBJ5paH5qGjJyk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGNvbnNvbGUubG9nKCflpITnkIblkI7nmoTlk43lupQ6Jywgb3V0cHV0KTsKICAgICAgICAKICAgICAgICB0aGlzLiRzZXQodGhpcy5tZXNzYWdlcywgbG9hZGluZ01zZ0luZGV4LCB7IAogICAgICAgICAgdHlwZTogJ2Fzc2lzdGFudCcsIAogICAgICAgICAgY29udGVudDogb3V0cHV0CiAgICAgICAgfSk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcignQ296ZSBBUEnosIPnlKjlpLHotKU6JywgZXJyb3IpOwogICAgICAgIGxldCBlcnJvck1lc3NhZ2UgPSAn5oqx5q2J77yM5pyN5Yqh5pqC5pe25LiN5Y+v55So77yM6K+356iN5ZCO5YaN6K+V44CCJzsKICAgICAgICAKICAgICAgICBpZiAoZXJyb3IgJiYgZXJyb3IuY29kZSA9PT0gNDAxNSkgewogICAgICAgICAgZXJyb3JNZXNzYWdlID0gJ+aKseatie+8jOaZuuiDveWKqeaJi+WwmuacquWujOaIkOmFjee9ru+8jOivt+eojeWQjuWGjeivleOAgic7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCfmnLrlmajkurrmnKrlj5HluIPliLBBUEnmuKDpgZPvvIzor7flhYjlnKhDb3pl5bmz5Y+w5Y+R5biD5py65Zmo5Lq6Jyk7CiAgICAgICAgfSBlbHNlIGlmIChlcnJvciAmJiBlcnJvci5tZXNzYWdlKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygn6ZSZ6K+v6K+m5oOFOicsIGVycm9yLm1lc3NhZ2UpOwogICAgICAgICAgZXJyb3JNZXNzYWdlID0gYOaKseatie+8jOWPkeeUn+S6humUmeivrzogJHtlcnJvci5tZXNzYWdlfWA7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHRoaXMuJHNldCh0aGlzLm1lc3NhZ2VzLCBsb2FkaW5nTXNnSW5kZXgsIHsgCiAgICAgICAgICB0eXBlOiAnYXNzaXN0YW50JywgCiAgICAgICAgICBjb250ZW50OiBlcnJvck1lc3NhZ2UKICAgICAgICB9KTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlOwogICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICAgIGlmICh0aGlzLiRyZWZzLm1lc3NhZ2VzQ29udGFpbmVyKSB7CiAgICAgICAgICAgIHRoaXMuJHJlZnMubWVzc2FnZXNDb250YWluZXIuc2Nyb2xsVG9wID0gdGhpcy4kcmVmcy5tZXNzYWdlc0NvbnRhaW5lci5zY3JvbGxIZWlnaHQ7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["CozeAssistant.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CozeAssistant.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"coze-assistant-container\" :class=\"{ 'coze-assistant-open': isOpen }\">\n    <div class=\"coze-assistant-toggle\" @click=\"toggleAssistant\">\n      <i :class=\"isOpen ? 'el-icon-close' : 'el-icon-s-comment'\"></i>\n    </div>\n    <div class=\"coze-assistant-content\" v-if=\"isOpen\">\n      <div class=\"coze-assistant-header\">\n        <span>智能助手</span>\n      </div>\n      <div class=\"coze-assistant-body\">\n        <div class=\"coze-assistant-messages\" ref=\"messagesContainer\">\n          <div v-for=\"(message, index) in messages\" :key=\"index\" class=\"message\" :class=\"message.type\">\n            <div class=\"message-content\">{{ message.content }}</div>\n          </div>\n        </div>\n        <div class=\"coze-assistant-input\">\n          <el-input\n            v-model=\"userInput\"\n            placeholder=\"请输入您的问题...\"\n            @keyup.enter.native=\"sendMessage\"\n          ></el-input>\n          <el-button type=\"primary\" icon=\"el-icon-s-promotion\" @click=\"sendMessage\"></el-button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n// 移除静态导入\n// import { CozeAPI } from '@coze/api';\n\nexport default {\n  name: 'CozeAssistant',\n  data() {\n    return {\n      isOpen: false,\n      userInput: '',\n      messages: [\n        { type: 'assistant', content: '您好，我是您的智能健康助手，有什么可以帮您的吗？' }\n      ],\n      apiClient: null,\n      isLoading: false\n    };\n  },\n  async created() {\n    try {\n      console.log('初始化CozeAPI客户端...');\n      \n      // 动态导入 CozeAPI\n      const { CozeAPI } = await import('@coze/api/dist/esm/index.js');\n      \n      // 初始化 API 客户端\n      this.apiClient = new CozeAPI({\n        token: 'pat_ZR3dhICDUSMapWasnt1NKW29LcoyvZlRVdKZetwZ5moYxCdzZq8Ju8MUGZmQoF2A',\n        baseURL: 'https://api.coze.cn',\n        allowPersonalAccessTokenInBrowser: true\n      });\n      \n      console.log('apiClient初始化结果:', this.apiClient);\n      \n      // 验证 apiClient 是否正确初始化\n      if (!this.apiClient) {\n        throw new Error('Coze API客户端初始化失败，apiClient为null');\n      }\n      \n      console.log('Coze API客户端初始化成功', this.apiClient);\n    } catch (error) {\n      console.error('Coze API客户端初始化失败:', error);\n      this.messages.push({ \n        type: 'assistant', \n        content: `智能助手初始化失败，请刷新页面重试。错误详情: ${error.message || '未知错误'}`\n      });\n    }\n  },\n  methods: {\n    toggleAssistant() {\n      this.isOpen = !this.isOpen;\n    },\n    async sendMessage() {\n      if (!this.userInput.trim() || this.isLoading) return;\n      \n      // 检查apiClient是否正确初始化\n      if (!this.apiClient) {\n        const errorMsg = '智能助手未正确初始化，请刷新页面重试';\n        console.error('智能助手未正确初始化，apiClient不存在');\n        this.messages.push({ \n          type: 'assistant', \n          content: errorMsg \n        });\n        return;\n      }\n      \n      // 添加用户消息\n      this.messages.push({ type: 'user', content: this.userInput });\n      const userQuestion = this.userInput;\n      this.userInput = '';\n      this.isLoading = true;\n      \n      // 添加临时加载消息\n      const loadingMsgIndex = this.messages.length;\n      this.messages.push({ type: 'assistant', content: '正在思考...' });\n      \n      try {\n        console.log('发送问题:', userQuestion);\n        \n        // 使用 chat 接口，添加 bot_id\n        const res = await this.apiClient.chat.create({\n          bot_id: '7514613032933277731',\n          messages: [{\n            role: 'user',\n            content: userQuestion\n          }]\n        });\n        \n        console.log('API完整响应:', JSON.stringify(res, null, 2));\n        \n        // 检查响应格式\n        if (!res) {\n          throw new Error('API响应为空');\n        }\n        \n        // 处理进行中的状态，需要轮询获取结果\n        if (res.status === 'in_progress' && res.id) {\n          console.log('对话正在进行中，开始轮询获取结果...');\n          let runId = res.id;\n          let maxRetries = 10;\n          let retryCount = 0;\n          let output = '';\n          \n          // 轮询获取结果\n          while (retryCount < maxRetries) {\n            await new Promise(resolve => setTimeout(resolve, 1000)); // 等待1秒\n            retryCount++;\n            \n            try {\n              console.log(`第${retryCount}次轮询获取结果...`);\n              const pollRes = await this.apiClient.chat.retrieve({\n                id: runId\n              });\n              \n              console.log('轮询响应:', JSON.stringify(pollRes, null, 2));\n              \n              // 检查是否完成\n              if (pollRes.status === 'completed' && pollRes.choices && pollRes.choices.length > 0) {\n                output = pollRes.choices[0].message.content;\n                console.log('获取到最终结果:', output);\n                break;\n              } else if (pollRes.status === 'failed') {\n                const errorMsg = pollRes.last_error && pollRes.last_error.msg ? pollRes.last_error.msg : '未知错误';\n                throw new Error('对话处理失败: ' + errorMsg);\n              }\n              \n              // 继续等待\n              console.log(`对话仍在处理中，继续等待... (${retryCount}/${maxRetries})`);\n            } catch (pollError) {\n              console.error('轮询过程中出错:', pollError);\n              throw pollError;\n            }\n          }\n          \n          if (!output) {\n            throw new Error('获取对话结果超时，请稍后再试');\n          }\n          \n          return this.$set(this.messages, loadingMsgIndex, { \n            type: 'assistant', \n            content: output\n          });\n        }\n        \n        // 尝试不同的响应格式\n        let output = '';\n        if (res.choices && res.choices.length > 0 && res.choices[0].message) {\n          output = res.choices[0].message.content;\n        } else if (res.data && res.data.output) {\n          output = res.data.output;\n        } else if (res.output) {\n          output = res.output;\n        } else if (typeof res === 'string') {\n          output = res;\n        } else {\n          console.error('无法识别的响应格式:', res);\n          throw new Error('无法识别的响应格式，请检查API文档');\n        }\n        \n        console.log('处理后的响应:', output);\n        \n        this.$set(this.messages, loadingMsgIndex, { \n          type: 'assistant', \n          content: output\n        });\n      } catch (error) {\n        console.error('Coze API调用失败:', error);\n        let errorMessage = '抱歉，服务暂时不可用，请稍后再试。';\n        \n        if (error && error.code === 4015) {\n          errorMessage = '抱歉，智能助手尚未完成配置，请稍后再试。';\n          console.error('机器人未发布到API渠道，请先在Coze平台发布机器人');\n        } else if (error && error.message) {\n          console.log('错误详情:', error.message);\n          errorMessage = `抱歉，发生了错误: ${error.message}`;\n        }\n        \n        this.$set(this.messages, loadingMsgIndex, { \n          type: 'assistant', \n          content: errorMessage\n        });\n      } finally {\n        this.isLoading = false;\n        this.$nextTick(() => {\n          if (this.$refs.messagesContainer) {\n            this.$refs.messagesContainer.scrollTop = this.$refs.messagesContainer.scrollHeight;\n          }\n        });\n      }\n    }\n  }\n};\n</script>\n\n<style scoped>\n.coze-assistant-container {\n  position: fixed;\n  bottom: 20px;\n  right: 20px;\n  z-index: 1000;\n}\n\n.coze-assistant-toggle {\n  width: 50px;\n  height: 50px;\n  border-radius: 50%;\n  background-color: #15559a;\n  color: white;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n}\n\n.coze-assistant-toggle i {\n  font-size: 24px;\n}\n\n.coze-assistant-content {\n  position: absolute;\n  bottom: 60px;\n  right: 0;\n  width: 350px;\n  height: 450px;\n  background-color: white;\n  border-radius: 8px;\n  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n}\n\n.coze-assistant-header {\n  padding: 10px 15px;\n  background-color: #15559a;\n  color: white;\n  font-weight: bold;\n}\n\n.coze-assistant-body {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  padding: 10px;\n  overflow: hidden;\n}\n\n.coze-assistant-messages {\n  flex: 1;\n  overflow-y: auto;\n  padding: 10px;\n}\n\n.message {\n  margin-bottom: 10px;\n  max-width: 80%;\n}\n\n.message.user {\n  margin-left: auto;\n}\n\n.message.assistant {\n  margin-right: auto;\n}\n\n.message-content {\n  padding: 8px 12px;\n  border-radius: 18px;\n  display: inline-block;\n  word-break: break-word;\n}\n\n.user .message-content {\n  background-color: #15559a;\n  color: white;\n}\n\n.assistant .message-content {\n  background-color: #f2f2f2;\n  color: #333;\n}\n\n.coze-assistant-input {\n  display: flex;\n  margin-top: 10px;\n}\n\n.coze-assistant-input .el-input {\n  flex: 1;\n  margin-right: 10px;\n}\n</style>"]}]}