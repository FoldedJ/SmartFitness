{"remainingRequest":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\SmartFitness\\smart-fitness-view\\src\\components\\CozeFloatingWindow.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\SmartFitness\\smart-fitness-view\\src\\components\\CozeFloatingWindow.vue","mtime":1749641728963},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1749639512193},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\babel-loader\\lib\\index.js","mtime":1749639511518},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1749639512193},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1749639525774}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGNhbGxDb3plV29ya2Zsb3dXaXRoU0RLIH0gZnJvbSAnQC9hcGkvY296ZVdvcmtmbG93JzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQ296ZUZsb2F0aW5nV2luZG93JywKICBwcm9wczogewogICAgd29ya2Zsb3dJZDogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICc3NTE0MzM5MjM0MzIxNjI5MjIwJyAvLyDpu5jorqTlt6XkvZzmtYFJRAogICAgfQogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG1pbmltaXplZDogdHJ1ZSwgLy8g6buY6K6k5pyA5bCP5YyWCiAgICAgIHVzZXJJbnB1dDogJycsCiAgICAgIG1lc3NhZ2VzOiBbCiAgICAgICAgeyB0eXBlOiAnYWknLCBjb250ZW50OiAn5oKo5aW977yB5oiR5piv5oKo55qE5YGl5bq35pm66IO95Yqp5omL77yM6K+36Zeu5pyJ5LuA5LmI5Y+v5Lul5biu5Yqp5oKo55qE77yfJyB9CiAgICAgIF0sCiAgICAgIGxvYWRpbmc6IGZhbHNlCiAgICB9OwogIH0sCiAgbW91bnRlZCgpIHsKICAgIC8vIOWIneWni+WMluaXtuajgOafpeaYr+WQpuWPr+S7peato+W4uOWKoOi9vQogICAgdGhpcy5jaGVja0Nvbm5lY3Rpb24oKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOajgOafpeS4juaJo+WtkEFJ5bel5L2c5rWB55qE6L+e5o6lCiAgICBhc3luYyBjaGVja0Nvbm5lY3Rpb24oKSB7CiAgICAgIHRyeSB7CiAgICAgICAgLy8g6I635Y+WdG9rZW4KICAgICAgICBjb25zdCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjb3plVG9rZW4nKTsKICAgICAgICAKICAgICAgICAvLyDlpoLmnpzmsqHmnIl0b2tlbu+8jOWwneivleS9v+eUqOm7mOiupHRva2VuCiAgICAgICAgaWYgKCF0b2tlbikgewogICAgICAgICAgY29uc29sZS53YXJuKCfmnKrorr7nva7miaPlrZBBSeW3peS9nOa1gXRva2Vu77yM5bCG5L2/55So6buY6K6kdG9rZW4nKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8g5rWL6K+VQVBJ6L+e5o6lCiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGkuY296ZS5jbi93b3JrZmxvd3MvcGluZycsIHsKICAgICAgICAgIG1ldGhvZDogJ0dFVCcsCiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3Rva2VuIHx8ICdwYXRfWlIzZGhJQ0RVU01hcFdhc250MU5LVzI5TGNveXZabFJWZEtaZXR3WjVtb1l4Q2R6WnE4SnU4TVVHWm1Rb0YyQSd9YCwKICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIAogICAgICAgIGlmICghcmVzcG9uc2Uub2spIHsKICAgICAgICAgIC8vIOajgOafpeaYr+WQpuaYr+aOiOadg+mXrumimAogICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxIHx8IHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAzKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihg5o6I5p2D5aSx6LSlOiB0b2tlbuWPr+iDveW3sui/h+acn+aIluaXoOaViCAo54q25oCB56CBOiAke3Jlc3BvbnNlLnN0YXR1c30pYCk7CiAgICAgICAgICB9CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYOi/nuaOpea1i+ivleWksei0pTogJHtyZXNwb25zZS5zdGF0dXN9IC0gJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBjb25zb2xlLmxvZygn5omj5a2QQUnlt6XkvZzmtYHov57mjqXmtYvor5XmiJDlip8nKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCfmiaPlrZBBSeW3peS9nOa1gei/nuaOpea1i+ivleWksei0pTonLCBlcnJvcik7CiAgICAgICAgCiAgICAgICAgLy8g5Yib5bu65aKe5by655qE6ZSZ6K+v5a+56LGhCiAgICAgICAgY29uc3QgZW5oYW5jZWRFcnJvciA9IG5ldyBFcnJvcihg6L+e5o6l5rWL6K+V5aSx6LSlOiAke2Vycm9yLm1lc3NhZ2V9YCk7CiAgICAgICAgZW5oYW5jZWRFcnJvci5vcmlnaW5hbEVycm9yID0gZXJyb3I7CiAgICAgICAgZW5oYW5jZWRFcnJvci5pc1Rva2VuRXJyb3IgPSBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCfmjojmnYPlpLHotKUnKSB8fCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygndG9rZW4nKSB8fCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnNDAxJykgfHwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJzQwMycpOwogICAgICAgIAogICAgICAgIC8vIOWPkemAgemUmeivr+WIsOeItue7hOS7tgogICAgICAgIHRoaXMuJGVtaXQoJ2Vycm9yJywgZW5oYW5jZWRFcnJvcik7CiAgICAgIH0KICAgIH0sCiAgICAKICAgIC8vIOWIh+aNoueql+WPo+eKtuaAgQogICAgdG9nZ2xlV2luZG93KCkgewogICAgICB0aGlzLm1pbmltaXplZCA9ICF0aGlzLm1pbmltaXplZDsKICAgICAgaWYgKCF0aGlzLm1pbmltaXplZCkgewogICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICAgIHRoaXMuc2Nyb2xsVG9Cb3R0b20oKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIAogICAgLy8g5pyA5bCP5YyW56qX5Y+jCiAgICBtaW5pbWl6ZVdpbmRvdygpIHsKICAgICAgdGhpcy5taW5pbWl6ZWQgPSB0cnVlOwogICAgfSwKICAgIAogICAgLy8g5YWz6Zet56qX5Y+jCiAgICBjbG9zZVdpbmRvdygpIHsKICAgICAgdGhpcy5taW5pbWl6ZWQgPSB0cnVlOwogICAgfSwKICAgIAogICAgLy8g5Y+R6YCB5raI5oGvCiAgICBhc3luYyBzZW5kTWVzc2FnZSgpIHsKICAgICAgaWYgKCF0aGlzLnVzZXJJbnB1dC50cmltKCkgfHwgdGhpcy5sb2FkaW5nKSByZXR1cm47CiAgICAgIAogICAgICAvLyDmt7vliqDnlKjmiLfmtojmga8KICAgICAgY29uc3QgdXNlck1lc3NhZ2UgPSB0aGlzLnVzZXJJbnB1dC50cmltKCk7CiAgICAgIHRoaXMubWVzc2FnZXMucHVzaCh7IHR5cGU6ICd1c2VyJywgY29udGVudDogdXNlck1lc3NhZ2UgfSk7CiAgICAgIHRoaXMudXNlcklucHV0ID0gJyc7CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgIAogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgdGhpcy5zY3JvbGxUb0JvdHRvbSgpOwogICAgICB9KTsKICAgICAgCiAgICAgIHRyeSB7CiAgICAgICAgLy8g6LCD55So5omj5a2QQUnlt6XkvZzmtYEKICAgICAgICBsZXQgYWlSZXNwb25zZSA9ICcnOwogICAgICAgIGxldCByZXNwb25zZVJlY2VpdmVkID0gZmFsc2U7CiAgICAgICAgCiAgICAgICAgLy8g5pi+56S65q2j5Zyo6L+e5o6l55qE5o+Q56S6CiAgICAgICAgdGhpcy5tZXNzYWdlcy5wdXNoKHsgdHlwZTogJ2FpJywgY29udGVudDogJ+ato+WcqOi/nuaOpeaZuuiDveWKqeaJiy4uLicgfSk7CiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgICAgdGhpcy5zY3JvbGxUb0JvdHRvbSgpOwogICAgICAgIH0pOwogICAgICAgIAogICAgICAgIC8vIOS9v+eUqOWinuW8uueJiGF4aW9z5rWB5byP6LCD55So5bel5L2c5rWBCiAgICAgICAgYXdhaXQgY2FsbENvemVXb3JrZmxvd1dpdGhTREsoCiAgICAgICAgICB0aGlzLndvcmtmbG93SWQsCiAgICAgICAgICB7IGlucHV0OiBKU09OLnN0cmluZ2lmeSh1c2VyTWVzc2FnZSkgfSwKICAgICAgICAgIG51bGwsIC8vIOS9v+eUqOm7mOiupHRva2VuCiAgICAgICAgICAoY2h1bmspID0+IHsKICAgICAgICAgICAgLy8g5pS25Yiw56ys5LiA5Liq5ZON5bqU5pe277yM56e76ZmkIuato+WcqOi/nuaOpSLmtojmga8KICAgICAgICAgICAgaWYgKCFyZXNwb25zZVJlY2VpdmVkKSB7CiAgICAgICAgICAgICAgcmVzcG9uc2VSZWNlaXZlZCA9IHRydWU7CiAgICAgICAgICAgICAgLy8g56e76Zmk5pyA5ZCO5LiA5p2h5raI5oGv77yI5q2j5Zyo6L+e5o6l5o+Q56S677yJCiAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlcy5wb3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgLy8g5aSE55CG5rWB5byP5ZON5bqUCiAgICAgICAgICAgIGlmIChjaHVuayAmJiBjaHVuay5kYXRhKSB7CiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIC8vIOWwneivleino+aekEpTT07lk43lupQKICAgICAgICAgICAgICAgIGNvbnN0IGpzb25EYXRhID0gSlNPTi5wYXJzZShjaHVuay5kYXRhKTsKICAgICAgICAgICAgICAgIGlmIChqc29uRGF0YSAmJiBqc29uRGF0YS5kYXRhICYmIGpzb25EYXRhLmRhdGEub3V0cHV0KSB7CiAgICAgICAgICAgICAgICAgIGFpUmVzcG9uc2UgPSBqc29uRGF0YS5kYXRhLm91dHB1dDsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoanNvbkRhdGEgJiYganNvbkRhdGEub3V0cHV0KSB7CiAgICAgICAgICAgICAgICAgIGFpUmVzcG9uc2UgPSBqc29uRGF0YS5vdXRwdXQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgLy8g5aaC5p6c5LiN5pivSlNPTuagvOW8j++8jOWPr+iDveaYr+e6r+aWh+acrOWTjeW6lAogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+aUtuWIsOmdnkpTT07lk43lupQ6JywgY2h1bmsuZGF0YSk7CiAgICAgICAgICAgICAgICAvLyDlsJ3or5Xku47lk43lupTkuK3mj5Dlj5bmnInnlKjkv6Hmga8KICAgICAgICAgICAgICAgIGNvbnN0IGRhdGFNYXRjaCA9IGNodW5rLmRhdGEubWF0Y2goLyJkYXRhIlxzKjpccyoiKFteIl0rKSIvaSk7CiAgICAgICAgICAgICAgICBpZiAoZGF0YU1hdGNoICYmIGRhdGFNYXRjaFsxXSkgewogICAgICAgICAgICAgICAgICBhaVJlc3BvbnNlID0gZGF0YU1hdGNoWzFdOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjaHVuay5kYXRhLmluY2x1ZGVzKCdvdXRwdXQnKSkgewogICAgICAgICAgICAgICAgICBjb25zdCBvdXRwdXRNYXRjaCA9IGNodW5rLmRhdGEubWF0Y2goLyJvdXRwdXQiXHMqOlxzKiIoW14iXSspIi9pKTsKICAgICAgICAgICAgICAgICAgaWYgKG91dHB1dE1hdGNoICYmIG91dHB1dE1hdGNoWzFdKSB7CiAgICAgICAgICAgICAgICAgICAgYWlSZXNwb25zZSA9IG91dHB1dE1hdGNoWzFdOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgKTsKICAgICAgICAKICAgICAgICAvLyDlpoLmnpzmsqHmnInmlLbliLDku7vkvZXlk43lupTvvIjov57mjqXmiJDlip/kvYbmsqHmnInlhoXlrrnvvIkKICAgICAgICBpZiAocmVzcG9uc2VSZWNlaXZlZCAmJiAhYWlSZXNwb25zZSkgewogICAgICAgICAgdGhpcy5tZXNzYWdlcy5wdXNoKHsgdHlwZTogJ2FpJywgY29udGVudDogJ+aKseatie+8jOaIkeaXoOazleeQhuino+aCqOeahOmXrumimO+8jOivt+mHjeaWsOaPj+i/sOOAgicgfSk7CiAgICAgICAgfSAKICAgICAgICAvLyDlpoLmnpzmlLbliLDkuoblk43lupQKICAgICAgICBlbHNlIGlmIChhaVJlc3BvbnNlKSB7CiAgICAgICAgICB0aGlzLm1lc3NhZ2VzLnB1c2goeyB0eXBlOiAnYWknLCBjb250ZW50OiBhaVJlc3BvbnNlIH0pOwogICAgICAgIH0gCiAgICAgICAgLy8g5aaC5p6c6L+e5o6l6YO95rKh5oiQ5YqfCiAgICAgICAgZWxzZSB7CiAgICAgICAgICB0aGlzLm1lc3NhZ2VzLnB1c2goeyB0eXBlOiAnYWknLCBjb250ZW50OiAn5oqx5q2J77yM5peg5rOV6L+e5o6l5Yiw5pm66IO95Yqp5omL5pyN5Yqh77yM6K+35qOA5p+l572R57uc6L+e5o6l5ZCO6YeN6K+V44CCJyB9KTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign6LCD55SoQUnlt6XkvZzmtYHlpLHotKU6JywgZXJyb3IpOwogICAgICAgIAogICAgICAgIC8vIOagueaNrumUmeivr+exu+Wei+aPkOS+m+S4jeWQjOeahOmUmeivr+a2iOaBrwogICAgICAgIGxldCBlcnJvck1lc3NhZ2UgPSAn5oqx5q2J77yM5pyN5Yqh5pqC5pe25LiN5Y+v55So77yM6K+356iN5ZCO5YaN6K+V44CCJzsKICAgICAgICAKICAgICAgICAvLyDmo4Dmn6XmmK/lkKbmmK90b2tlbumUmeivrwogICAgICAgIGlmIChlcnJvci5pc1Rva2VuRXJyb3IgfHwgCiAgICAgICAgICAgIChlcnJvci5tZXNzYWdlICYmIChlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCfmjojmnYPlpLHotKUnKSB8fCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygn5Luk54mMJykgfHwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ3Rva2VuJykpKSkgewogICAgICAgICAgZXJyb3JNZXNzYWdlID0gJ+aZuuiDveWKqeaJi+aOiOadg+Wksei0pe+8jOivt+iBlOezu+euoeeQhuWRmOabtOaWsOiuv+mXruS7pOeJjOOAgic7CiAgICAgICAgfSAKICAgICAgICAvLyDmo4Dmn6XmmK/lkKbmmK/nvZHnu5zplJnor68KICAgICAgICBlbHNlIGlmIChlcnJvci5tZXNzYWdlICYmIChlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdOZXR3b3JrJykgfHwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCfnvZHnu5wnKSB8fCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ3RpbWVvdXQnKSB8fCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ+i2heaXticpKSkgewogICAgICAgICAgZXJyb3JNZXNzYWdlID0gJ+e9kee7nOi/nuaOpeWksei0pe+8jOivt+ajgOafpeaCqOeahOe9kee7nOi/nuaOpeWQjumHjeivleOAgic7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHRoaXMubWVzc2FnZXMucHVzaCh7IHR5cGU6ICdhaScsIGNvbnRlbnQ6IGVycm9yTWVzc2FnZSB9KTsKICAgICAgICAKICAgICAgICAvLyDmt7vliqDph43or5XmjInpkq7nmoTmtojmga8KICAgICAgICB0aGlzLm1lc3NhZ2VzLnB1c2goeyAKICAgICAgICAgIHR5cGU6ICdhaScsIAogICAgICAgICAgY29udGVudDogJ+aCqOWPr+S7peeCueWHu+S4i+aWueaMiemSrumHjeivle+8jOaIluiAheeojeWQjuWGjeivleOAgicsCiAgICAgICAgICBpc1JldHJ5UHJvbXB0OiB0cnVlCiAgICAgICAgfSk7CiAgICAgICAgCiAgICAgICAgLy8g6YCa55+l54i257uE5Lu25Ye6546w6ZSZ6K+vCiAgICAgICAgdGhpcy4kZW1pdCgnZXJyb3InLCBlcnJvcik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgICAgdGhpcy5zY3JvbGxUb0JvdHRvbSgpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgCiAgICAvLyDmu5rliqjliLDlupXpg6gKICAgIHNjcm9sbFRvQm90dG9tKCkgewogICAgICBpZiAodGhpcy4kcmVmcy5jaGF0Q29udGVudCkgewogICAgICAgIHRoaXMuJHJlZnMuY2hhdENvbnRlbnQuc2Nyb2xsVG9wID0gdGhpcy4kcmVmcy5jaGF0Q29udGVudC5zY3JvbGxIZWlnaHQ7CiAgICAgIH0KICAgIH0sCiAgICAKICAgIC8vIOmHjeivleS4iuS4gOadoeeUqOaIt+a2iOaBrwogICAgcmV0cnlMYXN0TWVzc2FnZSgpIHsKICAgICAgLy8g5p+l5om+5pyA5ZCO5LiA5p2h55So5oi35raI5oGvCiAgICAgIGNvbnN0IGxhc3RVc2VyTWVzc2FnZUluZGV4ID0gWy4uLnRoaXMubWVzc2FnZXNdLnJldmVyc2UoKQogICAgICAgIC5maW5kSW5kZXgobXNnID0+IG1zZy50eXBlID09PSAndXNlcicpOwogICAgICAKICAgICAgaWYgKGxhc3RVc2VyTWVzc2FnZUluZGV4ICE9PSAtMSkgewogICAgICAgIGNvbnN0IGxhc3RVc2VyTWVzc2FnZSA9IHRoaXMubWVzc2FnZXNbdGhpcy5tZXNzYWdlcy5sZW5ndGggLSAxIC0gbGFzdFVzZXJNZXNzYWdlSW5kZXhdOwogICAgICAgIAogICAgICAgIC8vIOenu+mZpOaJgOaciemUmeivr+ebuOWFs+eahOa2iOaBr++8iOS7jueUqOaIt+a2iOaBr+S5i+WQjueahOaJgOaciUFJ5raI5oGv77yJCiAgICAgICAgY29uc3QgdXNlck1lc3NhZ2VQb3NpdGlvbiA9IHRoaXMubWVzc2FnZXMubGVuZ3RoIC0gMSAtIGxhc3RVc2VyTWVzc2FnZUluZGV4OwogICAgICAgIHRoaXMubWVzc2FnZXMgPSB0aGlzLm1lc3NhZ2VzLnNsaWNlKDAsIHVzZXJNZXNzYWdlUG9zaXRpb24gKyAxKTsKICAgICAgICAKICAgICAgICAvLyDph43mlrDlj5HpgIHor6Xmtojmga8KICAgICAgICB0aGlzLnVzZXJJbnB1dCA9IGxhc3RVc2VyTWVzc2FnZS5jb250ZW50OwogICAgICAgIHRoaXMuc2VuZE1lc3NhZ2UoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyDlpoLmnpzmsqHmnInmib7liLDnlKjmiLfmtojmga/vvIzmt7vliqDmj5DnpLoKICAgICAgICB0aGlzLm1lc3NhZ2VzLnB1c2goeyAKICAgICAgICAgIHR5cGU6ICdhaScsIAogICAgICAgICAgY29udGVudDogJ+ayoeacieaJvuWIsOWPr+S7pemHjeivleeahOa2iOaBr++8jOivt+i+k+WFpeaWsOeahOmXrumimOOAgicgCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["CozeFloatingWindow.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqDA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CozeFloatingWindow.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"coze-floating-window\" :class=\"{ 'minimized': minimized }\">\n    <!-- 悬浮按钮 -->\n    <div class=\"floating-button\" @click=\"toggleWindow\" v-if=\"minimized\">\n      <i class=\"el-icon-s-promotion\"></i>\n    </div>\n    \n    <!-- 聊天窗口 -->\n    <div class=\"chat-window\" v-else>\n      <!-- 窗口标题栏 -->\n      <div class=\"window-header\">\n        <div class=\"title\">健康智能助手</div>\n        <div class=\"controls\">\n          <i class=\"el-icon-minus\" @click=\"minimizeWindow\"></i>\n          <i class=\"el-icon-close\" @click=\"closeWindow\"></i>\n        </div>\n      </div>\n      \n      <!-- 聊天内容区域 -->\n      <div class=\"chat-content\" ref=\"chatContent\">\n        <div v-for=\"(message, index) in messages\" :key=\"index\" \n             :class=\"['message', message.type === 'user' ? 'user-message' : 'ai-message']\">\n          <div class=\"message-content\">{{ message.content }}</div>\n          <!-- 重试按钮 -->\n          <div v-if=\"message.isRetryPrompt\" class=\"retry-button-container\">\n            <el-button size=\"small\" type=\"primary\" @click=\"retryLastMessage\" :disabled=\"loading\">\n              <i class=\"el-icon-refresh-right\"></i> 重试\n            </el-button>\n          </div>\n        </div>\n        <div v-if=\"loading\" class=\"loading-indicator\">\n          <i class=\"el-icon-loading\"></i> 思考中...\n        </div>\n      </div>\n      \n      <!-- 输入区域 -->\n      <div class=\"input-area\">\n        <el-input\n          v-model=\"userInput\"\n          type=\"textarea\"\n          :rows=\"2\"\n          placeholder=\"请输入您的问题...\"\n          @keyup.enter.native=\"sendMessage\"\n        ></el-input>\n        <el-button type=\"primary\" icon=\"el-icon-s-promotion\" @click=\"sendMessage\" :loading=\"loading\">\n          发送\n        </el-button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { callCozeWorkflowWithSDK } from '@/api/cozeWorkflow';\n\nexport default {\n  name: 'CozeFloatingWindow',\n  props: {\n    workflowId: {\n      type: String,\n      default: '7514339234321629220' // 默认工作流ID\n    }\n  },\n  data() {\n    return {\n      minimized: true, // 默认最小化\n      userInput: '',\n      messages: [\n        { type: 'ai', content: '您好！我是您的健康智能助手，请问有什么可以帮助您的？' }\n      ],\n      loading: false\n    };\n  },\n  mounted() {\n    // 初始化时检查是否可以正常加载\n    this.checkConnection();\n  },\n  methods: {\n    // 检查与扣子AI工作流的连接\n    async checkConnection() {\n      try {\n        // 获取token\n        const token = localStorage.getItem('cozeToken');\n        \n        // 如果没有token，尝试使用默认token\n        if (!token) {\n          console.warn('未设置扣子AI工作流token，将使用默认token');\n        }\n        \n        // 测试API连接\n        const response = await fetch('https://api.coze.cn/workflows/ping', {\n          method: 'GET',\n          headers: {\n            'Authorization': `Bearer ${token || 'pat_ZR3dhICDUSMapWasnt1NKW29LcoyvZlRVdKZetwZ5moYxCdzZq8Ju8MUGZmQoF2A'}`,\n            'Content-Type': 'application/json'\n          }\n        });\n        \n        if (!response.ok) {\n          // 检查是否是授权问题\n          if (response.status === 401 || response.status === 403) {\n            throw new Error(`授权失败: token可能已过期或无效 (状态码: ${response.status})`);\n          }\n          throw new Error(`连接测试失败: ${response.status} - ${response.statusText}`);\n        }\n        \n        console.log('扣子AI工作流连接测试成功');\n      } catch (error) {\n        console.error('扣子AI工作流连接测试失败:', error);\n        \n        // 创建增强的错误对象\n        const enhancedError = new Error(`连接测试失败: ${error.message}`);\n        enhancedError.originalError = error;\n        enhancedError.isTokenError = error.message.includes('授权失败') || \n                                    error.message.includes('token') || \n                                    error.message.includes('401') || \n                                    error.message.includes('403');\n        \n        // 发送错误到父组件\n        this.$emit('error', enhancedError);\n      }\n    },\n    \n    // 切换窗口状态\n    toggleWindow() {\n      this.minimized = !this.minimized;\n      if (!this.minimized) {\n        this.$nextTick(() => {\n          this.scrollToBottom();\n        });\n      }\n    },\n    \n    // 最小化窗口\n    minimizeWindow() {\n      this.minimized = true;\n    },\n    \n    // 关闭窗口\n    closeWindow() {\n      this.minimized = true;\n    },\n    \n    // 发送消息\n    async sendMessage() {\n      if (!this.userInput.trim() || this.loading) return;\n      \n      // 添加用户消息\n      const userMessage = this.userInput.trim();\n      this.messages.push({ type: 'user', content: userMessage });\n      this.userInput = '';\n      this.loading = true;\n      \n      this.$nextTick(() => {\n        this.scrollToBottom();\n      });\n      \n      try {\n        // 调用扣子AI工作流\n        let aiResponse = '';\n        let responseReceived = false;\n        \n        // 显示正在连接的提示\n        this.messages.push({ type: 'ai', content: '正在连接智能助手...' });\n        this.$nextTick(() => {\n          this.scrollToBottom();\n        });\n        \n        // 使用增强版axios流式调用工作流\n        await callCozeWorkflowWithSDK(\n          this.workflowId,\n          { input: JSON.stringify(userMessage) },\n          null, // 使用默认token\n          (chunk) => {\n            // 收到第一个响应时，移除\"正在连接\"消息\n            if (!responseReceived) {\n              responseReceived = true;\n              // 移除最后一条消息（正在连接提示）\n              this.messages.pop();\n            }\n            \n            // 处理流式响应\n            if (chunk && chunk.data) {\n              try {\n                // 尝试解析JSON响应\n                const jsonData = JSON.parse(chunk.data);\n                if (jsonData && jsonData.data && jsonData.data.output) {\n                  aiResponse = jsonData.data.output;\n                } else if (jsonData && jsonData.output) {\n                  aiResponse = jsonData.output;\n                }\n              } catch (e) {\n                // 如果不是JSON格式，可能是纯文本响应\n                console.log('收到非JSON响应:', chunk.data);\n                // 尝试从响应中提取有用信息\n                const dataMatch = chunk.data.match(/\"data\"\\s*:\\s*\"([^\"]+)\"/i);\n                if (dataMatch && dataMatch[1]) {\n                  aiResponse = dataMatch[1];\n                } else if (chunk.data.includes('output')) {\n                  const outputMatch = chunk.data.match(/\"output\"\\s*:\\s*\"([^\"]+)\"/i);\n                  if (outputMatch && outputMatch[1]) {\n                    aiResponse = outputMatch[1];\n                  }\n                }\n              }\n            }\n          }\n        );\n        \n        // 如果没有收到任何响应（连接成功但没有内容）\n        if (responseReceived && !aiResponse) {\n          this.messages.push({ type: 'ai', content: '抱歉，我无法理解您的问题，请重新描述。' });\n        } \n        // 如果收到了响应\n        else if (aiResponse) {\n          this.messages.push({ type: 'ai', content: aiResponse });\n        } \n        // 如果连接都没成功\n        else {\n          this.messages.push({ type: 'ai', content: '抱歉，无法连接到智能助手服务，请检查网络连接后重试。' });\n        }\n      } catch (error) {\n        console.error('调用AI工作流失败:', error);\n        \n        // 根据错误类型提供不同的错误消息\n        let errorMessage = '抱歉，服务暂时不可用，请稍后再试。';\n        \n        // 检查是否是token错误\n        if (error.isTokenError || \n            (error.message && (error.message.includes('授权失败') || \n                              error.message.includes('令牌') || \n                              error.message.includes('token')))) {\n          errorMessage = '智能助手授权失败，请联系管理员更新访问令牌。';\n        } \n        // 检查是否是网络错误\n        else if (error.message && (error.message.includes('Network') || \n                                  error.message.includes('网络') || \n                                  error.message.includes('timeout') || \n                                  error.message.includes('超时'))) {\n          errorMessage = '网络连接失败，请检查您的网络连接后重试。';\n        }\n        \n        this.messages.push({ type: 'ai', content: errorMessage });\n        \n        // 添加重试按钮的消息\n        this.messages.push({ \n          type: 'ai', \n          content: '您可以点击下方按钮重试，或者稍后再试。',\n          isRetryPrompt: true\n        });\n        \n        // 通知父组件出现错误\n        this.$emit('error', error);\n      } finally {\n        this.loading = false;\n        this.$nextTick(() => {\n          this.scrollToBottom();\n        });\n      }\n    },\n    \n    // 滚动到底部\n    scrollToBottom() {\n      if (this.$refs.chatContent) {\n        this.$refs.chatContent.scrollTop = this.$refs.chatContent.scrollHeight;\n      }\n    },\n    \n    // 重试上一条用户消息\n    retryLastMessage() {\n      // 查找最后一条用户消息\n      const lastUserMessageIndex = [...this.messages].reverse()\n        .findIndex(msg => msg.type === 'user');\n      \n      if (lastUserMessageIndex !== -1) {\n        const lastUserMessage = this.messages[this.messages.length - 1 - lastUserMessageIndex];\n        \n        // 移除所有错误相关的消息（从用户消息之后的所有AI消息）\n        const userMessagePosition = this.messages.length - 1 - lastUserMessageIndex;\n        this.messages = this.messages.slice(0, userMessagePosition + 1);\n        \n        // 重新发送该消息\n        this.userInput = lastUserMessage.content;\n        this.sendMessage();\n      } else {\n        // 如果没有找到用户消息，添加提示\n        this.messages.push({ \n          type: 'ai', \n          content: '没有找到可以重试的消息，请输入新的问题。' \n        });\n      }\n    }\n  }\n};\n</script>\n\n<style scoped>\n.coze-floating-window {\n  position: fixed;\n  right: 20px;\n  bottom: 20px;\n  z-index: 9999;\n  font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;\n}\n\n.floating-button {\n  width: 60px;\n  height: 60px;\n  border-radius: 50%;\n  background-color: #15559a;\n  color: white;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n  transition: all 0.3s ease;\n}\n\n.floating-button i {\n  font-size: 24px;\n}\n\n.floating-button:hover {\n  transform: scale(1.05);\n  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);\n}\n\n.chat-window {\n  width: 350px;\n  height: 500px;\n  border-radius: 10px;\n  background-color: white;\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  transition: all 0.3s ease;\n}\n\n.window-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 16px;\n  background-color: #15559a;\n  color: white;\n}\n\n.title {\n  font-weight: bold;\n  font-size: 16px;\n}\n\n.controls i {\n  margin-left: 12px;\n  cursor: pointer;\n  font-size: 16px;\n}\n\n.chat-content {\n  flex: 1;\n  padding: 16px;\n  overflow-y: auto;\n  background-color: #f9f9f9;\n}\n\n.message {\n  margin-bottom: 12px;\n  display: flex;\n  flex-direction: column;\n}\n\n.user-message {\n  align-items: flex-end;\n}\n\n.ai-message {\n  align-items: flex-start;\n}\n\n.message-content {\n  max-width: 80%;\n  padding: 10px 14px;\n  border-radius: 18px;\n  word-break: break-word;\n  line-height: 1.5;\n  font-size: 14px;\n}\n\n.retry-button-container {\n  display: flex;\n  justify-content: center;\n  margin-top: 8px;\n  margin-bottom: 12px;\n}\n\n.user-message .message-content {\n  background-color: #15559a;\n  color: white;\n  border-bottom-right-radius: 4px;\n}\n\n.ai-message .message-content {\n  background-color: #e9e9eb;\n  color: #333;\n  border-bottom-left-radius: 4px;\n}\n\n.loading-indicator {\n  display: flex;\n  align-items: center;\n  color: #999;\n  font-size: 14px;\n  margin: 8px 0;\n}\n\n.loading-indicator i {\n  margin-right: 6px;\n}\n\n.input-area {\n  padding: 12px;\n  border-top: 1px solid #eee;\n  display: flex;\n  align-items: flex-end;\n}\n\n.input-area .el-textarea {\n  flex: 1;\n  margin-right: 8px;\n}\n\n.input-area .el-button {\n  background-color: #15559a;\n  border-color: #15559a;\n}\n</style>"]}]}