{"remainingRequest":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\babel-loader\\lib\\index.js!E:\\SmartFitness\\smart-fitness-view\\src\\api\\cozeWorkflow.js","dependencies":[{"path":"E:\\SmartFitness\\smart-fitness-view\\src\\api\\cozeWorkflow.js","mtime":1749643338708},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1749639512193},{"path":"E:\\SmartFitness\\smart-fitness-view\\node_modules\\babel-loader\\lib\\index.js","mtime":1749639511518}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgQ296ZUFQSSB9IGZyb20gJ0Bjb3plL2FwaSc7IC8vIOWIm+W7ukNvemUgQVBJ5a6i5oi356uvCgpjb25zdCBjcmVhdGVDb3plQ2xpZW50ID0gKCkgPT4gewogIGNvbnN0IHRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2NvemVUb2tlbicpIHx8ICdwYXRfWlIzZGhJQ0RVU01hcFdhc250MU5LVzI5TGNveXZabFJWZEtaZXR3WjVtb1l4Q2R6WnE4SnU4TVVHWm1Rb0YyQSc7CiAgcmV0dXJuIG5ldyBDb3plQVBJKHsKICAgIHRva2VuOiB0b2tlbiwKICAgIGJhc2VVUkw6ICdodHRwczovL2FwaS5jb3plLmNuJwogIH0pOwp9OyAvLyDlj5HpgIHmtojmga/liLBDb3pl5bel5L2c5rWBCgoKZXhwb3J0IGNvbnN0IHNlbmRNZXNzYWdlVG9Xb3JrZmxvdyA9IGFzeW5jICh3b3JrZmxvd0lkLCBtZXNzYWdlKSA9PiB7CiAgdHJ5IHsKICAgIGNvbnNvbGUubG9nKCflh4blpIflj5HpgIHmtojmga86JywgewogICAgICB3b3JrZmxvd0lkLAogICAgICBtZXNzYWdlCiAgICB9KTsKICAgIGNvbnN0IGNsaWVudCA9IGNyZWF0ZUNvemVDbGllbnQoKTsKICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2xpZW50LndvcmtmbG93cy5ydW5zLnN0cmVhbSh7CiAgICAgIHdvcmtmbG93X2lkOiA3NTE0MzM5MjM0MzIxNjI5MjIwLAogICAgICBwYXJhbWV0ZXJzOiB7CiAgICAgICAgaW5wdXQ6IEpTT04uc3RyaW5naWZ5KG1lc3NhZ2UpCiAgICAgIH0KICAgIH0pOwogICAgY29uc29sZS5sb2coJ0FQSeWTjeW6lDonLCByZXNwb25zZSk7CgogICAgaWYgKCFyZXNwb25zZSB8fCAhcmVzcG9uc2UuZGF0YSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ0FQSeWTjeW6lOagvOW8j+mUmeivrycpOwogICAgfQoKICAgIHJldHVybiB7CiAgICAgIGNob2ljZXM6IFt7CiAgICAgICAgbWVzc2FnZTogewogICAgICAgICAgY29udGVudDogcmVzcG9uc2UuZGF0YS5vdXRwdXQKICAgICAgICB9CiAgICAgIH1dCiAgICB9OwogIH0gY2F0Y2ggKGVycm9yKSB7CiAgICBjb25zb2xlLmVycm9yKCflj5HpgIHmtojmga/lpLHotKU6JywgZXJyb3IpOwogICAgdGhyb3cgZXJyb3I7CiAgfQp9OyAvLyDmm7TmlrB0b2tlbgoKZXhwb3J0IGNvbnN0IHVwZGF0ZUNvemVUb2tlbiA9IHRva2VuID0+IHsKICB0cnkgewogICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NvemVUb2tlbicsIHRva2VuKTsKICAgIHJldHVybiB0cnVlOwogIH0gY2F0Y2ggKGVycm9yKSB7CiAgICBjb25zb2xlLmVycm9yKCfmm7TmlrB0b2tlbuWksei0pTonLCBlcnJvcik7CiAgICByZXR1cm4gZmFsc2U7CiAgfQp9Ow=="},{"version":3,"sources":["E:/SmartFitness/smart-fitness-view/src/api/cozeWorkflow.js"],"names":["CozeAPI","createCozeClient","token","localStorage","getItem","baseURL","sendMessageToWorkflow","workflowId","message","console","log","client","response","workflows","runs","stream","workflow_id","parameters","input","JSON","stringify","data","Error","choices","content","output","error","updateCozeToken","setItem"],"mappings":"AAAA,SAASA,OAAT,QAAwB,WAAxB,C,CAEA;;AACA,MAAMC,gBAAgB,GAAG,MAAM;AAC3B,QAAMC,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,WAArB,KAAqC,sEAAnD;AAEA,SAAO,IAAIJ,OAAJ,CAAY;AACfE,IAAAA,KAAK,EAAEA,KADQ;AAEfG,IAAAA,OAAO,EAAE;AAFM,GAAZ,CAAP;AAIH,CAPD,C,CASA;;;AACA,OAAO,MAAMC,qBAAqB,GAAG,OAAOC,UAAP,EAAmBC,OAAnB,KAA+B;AAChE,MAAI;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAuB;AAAEH,MAAAA,UAAF;AAAcC,MAAAA;AAAd,KAAvB;AACA,UAAMG,MAAM,GAAGV,gBAAgB,EAA/B;AAEA,UAAMW,QAAQ,GAAG,MAAMD,MAAM,CAACE,SAAP,CAAiBC,IAAjB,CAAsBC,MAAtB,CAA6B;AAChDC,MAAAA,WAAW,EAAE,mBADmC;AAEhDC,MAAAA,UAAU,EAAE;AACRC,QAAAA,KAAK,EAAEC,IAAI,CAACC,SAAL,CAAeZ,OAAf;AADC;AAFoC,KAA7B,CAAvB;AAOAC,IAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBE,QAAtB;;AAEA,QAAI,CAACA,QAAD,IAAa,CAACA,QAAQ,CAACS,IAA3B,EAAiC;AAC7B,YAAM,IAAIC,KAAJ,CAAU,WAAV,CAAN;AACH;;AAED,WAAO;AACHC,MAAAA,OAAO,EAAE,CAAC;AACNf,QAAAA,OAAO,EAAE;AACLgB,UAAAA,OAAO,EAAEZ,QAAQ,CAACS,IAAT,CAAcI;AADlB;AADH,OAAD;AADN,KAAP;AAOH,GAxBD,CAwBE,OAAOC,KAAP,EAAc;AACZjB,IAAAA,OAAO,CAACiB,KAAR,CAAc,SAAd,EAAyBA,KAAzB;AACA,UAAMA,KAAN;AACH;AACJ,CA7BM,C,CA+BP;;AACA,OAAO,MAAMC,eAAe,GAAIzB,KAAD,IAAW;AACtC,MAAI;AACAC,IAAAA,YAAY,CAACyB,OAAb,CAAqB,WAArB,EAAkC1B,KAAlC;AACA,WAAO,IAAP;AACH,GAHD,CAGE,OAAOwB,KAAP,EAAc;AACZjB,IAAAA,OAAO,CAACiB,KAAR,CAAc,YAAd,EAA4BA,KAA5B;AACA,WAAO,KAAP;AACH;AACJ,CARM","sourcesContent":["import { CozeAPI } from '@coze/api';\r\n\r\n// 创建Coze API客户端\r\nconst createCozeClient = () => {\r\n    const token = localStorage.getItem('cozeToken') || 'pat_ZR3dhICDUSMapWasnt1NKW29LcoyvZlRVdKZetwZ5moYxCdzZq8Ju8MUGZmQoF2A';\r\n    \r\n    return new CozeAPI({\r\n        token: token,\r\n        baseURL: 'https://api.coze.cn'\r\n    });\r\n};\r\n\r\n// 发送消息到Coze工作流\r\nexport const sendMessageToWorkflow = async (workflowId, message) => {\r\n    try {\r\n        console.log('准备发送消息:', { workflowId, message });\r\n        const client = createCozeClient();\r\n        \r\n        const response = await client.workflows.runs.stream({\r\n            workflow_id: 7514339234321629220,\r\n            parameters: {\r\n                input: JSON.stringify(message)\r\n            }\r\n        });\r\n\r\n        console.log('API响应:', response);\r\n\r\n        if (!response || !response.data) {\r\n            throw new Error('API响应格式错误');\r\n        }\r\n\r\n        return {\r\n            choices: [{\r\n                message: {\r\n                    content: response.data.output\r\n                }\r\n            }]\r\n        };\r\n    } catch (error) {\r\n        console.error('发送消息失败:', error);\r\n        throw error;\r\n    }\r\n};\r\n\r\n// 更新token\r\nexport const updateCozeToken = (token) => {\r\n    try {\r\n        localStorage.setItem('cozeToken', token);\r\n        return true;\r\n    } catch (error) {\r\n        console.error('更新token失败:', error);\r\n        return false;\r\n    }\r\n};"]}]}